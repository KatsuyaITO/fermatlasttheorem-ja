# 第11節:モジュラー曲線

モジュラー曲線は現代数論の中心的対象であり、有限位数の点や巡回部分群などの「レベル構造」を備えた**エリプティック曲線**を考察すると自然に現れます。歴史的には、これらは $$\mathrm{SL}_2(\mathbb{Z})$$ の部分群による複素上半平面の商として初めて研究されましたが、20世紀に入り、これらの商は**モジュライ理論**の言葉で再解釈できることが明らかになりました。すなわち、「レベル構造付きエリプティック曲線」をパラメトライズする空間とみなせるのです。

本節では、代表的なモジュラー曲線である $$X_0(N)$$ に焦点を当てます。これは位数 $$N$$ の巡回部分群をもつエリプティック曲線を類似同型（isomorphism）で分類するモジュライ空間です。この曲線の**ヤコビ多様体**や、**狭点**（cusp）の近傍での函数の振る舞い（$$q$$-展開）、そして**ヘッケ代数**の作用などを調べることにより、ガロワ表現の算術との結びつきが見えてきます。これらはワイルズによるフェルマーの最終定理の証明に至る多くの重要な結果を下支えしています。

***

## 11.1 $$X_0(N)$$ のモジュライ空間としての解釈

### 11.1.1 直観的なイメージ

1.  **エリプティック曲線とレベル** $$N$$ **構造**\
    エリプティック曲線 $$E$$ とは、基点 $$\mathcal{O}$$（加法群の単位元）を指定した種数1の滑らかな射影曲線です。ある意味で「レベル $$N$$ 構造」を指定するとは、エリプティック曲線上に**位数** $$N$$ **の巡回部分群**を与えることに相当します。

    $$
    \text{レベル } N\text{ 構造} \;=\; \bigl(C \subset E \;\text{かつ}\; C \cong \mathbb{Z}/N\mathbb{Z}\bigr).
    $$

    モジュラー曲線 $$X_0(N)$$ は、「エリプティック曲線 $$E$$ とその上の位数 $$N$$ の巡回部分群 $$C$$ の組」を同型を除いて分類するモジュライ空間として定義されます。

    > **定義（エリプティック曲線）**\
    > 体 $$k$$ 上のエリプティック曲線 $$E$$ とは、(射影化した) 非特異な3次曲線
    >
    > $$
    > y^2 = x^3 + ax + b \quad (\text{あるいは適切なワイヤストラス方程式})
    > $$
    >
    > と、その上の特別な点 $$\mathcal{O}$$（加法群の単位）からなる組である。複素数体 $$\mathbb{C}$$ 上では、$$\Lambda$$ を格子とすると $$E\cong \mathbb{C}/\Lambda$$ と同一視できる。
2. **なぜ** $$X_0(N)$$ **を考えるのか**\
   エリプティック曲線に位数 $$N$$ の巡回部分群を付加すると、エリプティック曲線を「レベル構造」という算術的制約で分類できるようになります。$$X_0(N)$$ は、そうした構造を持つエリプティック曲線を**同型類**ごとに「まとめ上げる」強力な枠組みを与えます。さらに、この構成は**モジュラー形式**の理論と密接に絡み合い、解析的手法と代数的手法を両立させるためにも重要です。
3. **歴史的背景**
   * 19世紀には、クラインやフリッケらが、ある種の「モジュラー函数」を研究するために、$$\mathrm{SL}_2(\mathbb{Z})$$ の部分群による上半平面 $$\mathcal{H}$$ の商を取り扱っていました。
   * 20世紀になると、これらの商に有限個の**狭点（cusp）を付け加えてコンパクト化**することで、コンパクトなリーマン面となり、さらに**代数曲線**として数体上に定義できることが示されました。
   * その後、デルigneやドリンフェルトらの研究により、これらの曲線が「レベル構造付きエリプティック曲線」のモジュライ空間として再解釈できるモダンな枠組みが整備され、算術的な応用（モジュラー性やガロワ表現との関係など）へと結びついていきました。その集大成が、ワイルズによるフェルマーの最終定理の証明を含む数々の大きな進展です。

***

### 11.1.2 $$X_0(N)$$ の定義と基本性質

1.  **解析的定義**\
    $$\mathrm{SL}_2(\mathbb{Z})$$ の部分群 $$\Gamma_0(N)$$ を

    $$
    \Gamma_0(N) \;=\;\Bigl\{\,\begin{pmatrix} a & b \\ c & d \end{pmatrix} \in \mathrm{SL}_2(\mathbb{Z}) \;\Bigm|\; c \equiv 0 \;(\bmod N) \Bigr\}
    $$

    と定義する。すると、複素数体上のモジュラー曲線 $$X_0(N)(\mathbb{C})$$ はリーマン面として

    $$
    X_0(N)(\mathbb{C}) \;=\; \Gamma_0(N)\bigl\backslash \bigl(\mathcal{H} \cup \{\text{cusps}\}\bigr)
    $$

    と同一視される。ここで $$\mathcal{H}$$ は「上半平面」$$\{z\in \mathbb{C} : \operatorname{Im}(z) > 0\}$$ であり、「cusps」は有理境界点 $$\mathbb{P}^1(\mathbb{Q})$$ の同値類を追加してコンパクト化を行うためのものを指す。
2.  **代数幾何的なモジュライ解釈**\
    代数幾何の言葉では、$$X_0(N)$$ は次の関手を表す「粗モジュライスキーム（coarse moduli scheme）」として特徴づけられます：

    $$
    S \;\mapsto\; \Bigl\{\,(E_S, C_S) : S \text{上のエリプティック曲線 } E_S,\; E_S[N]\text{ 内の巡回部分群 }C_S,\; |C_S|=N \Bigr\}\,/\,\cong.
    $$

    つまり、$$k$$-点 $$X_0(N)(k)$$ は、(同型を除く) $$\bigl(E, C\bigr)$$ の組を与えます。この「モジュライ」の視点は、解析的商 $$\Gamma_0(N)\backslash \mathcal{H}$$ との対応付けだけでなく、エリプティック曲線の算術的性質を考察する上でも重要です。

    > **定義（粗モジュライスキーム）**\
    > あるモジュライ問題 $$\mathcal{F}$$ に対して、その**粗モジュライスキーム** $$M$$ とは、(1) $$\mathcal{F}$$ を表す普遍族（universal family）から自然な写像を受け取り、(2) $$\mathcal{F}$$ を分類する他の任意のスキームはこの写像を通じて因数分解する、という普遍性を満たすスキームのことである。直感的には、「$$\mathcal{F}$$ の対象を分類する」ことを最も近似的かつ整合的に実現する代数的対象と言える。
3. **普遍性**\
   $$X_0(N)$$ 上には、(厳密にはその有限被覆上で)「普遍族」が存在する。すなわち、$$\mathrm{Spec}(k)\to X_0(N)$$ という写像を引き戻すことで、その係数体 $$k$$ 上に位数 $$N$$ の巡回部分群を持つエリプティック曲線を得ることができる。この性質は、具体的な問題設定で「レベル構造付きエリプティック曲線の族」を構成するときに鍵となる。
4.  **次元と種数**\
    $$X_0(N)$$ は（複素的に見て）1次元の射影代数曲線であり、その種数 $$g(X_0(N))$$ は $$N$$ が大きくなるにつれ概ね増大していく。古典的には、上半平面上の周期的点（楕円点）や狭点（cusps）の $$\Gamma_0(N)$$ 軌道から種数を計算する公式が知られている。例えば、小さな $$N$$ では以下のように求まる：

    $$
    g\bigl(X_0(11)\bigr) = 1,\quad g\bigl(X_0(14)\bigr) = 2,\quad g\bigl(X_0(15)\bigr) = 1,\quad \dots
    $$

    これらの種数計算は、文献に見られる具体例や分類結果の基礎となっている。

***

## 11.2 $$q$$-展開と幾何学的解釈

### 11.2.1 狭点近傍での正則微分と $$q$$-展開

1. $$X_0(N)$$ **上の正則微分**\
   ウェイト2のモジュラー形式で適切な狭点での成長条件を課したもの（カスプ形式）と、$$X_0(N)$$ 上の正則微分 $$\Omega^1(X_0(N))$$ は同一視できる。具体的には、ウェイト2のカスプ形式 $$f(z)$$ は、$$\Gamma_0(N)\backslash \mathcal{H}$$ 上で適切に見れば、$$X_0(N)$$ の正則1-形式に対応する。カスプ形式の空間をしばしば $$S_2(\Gamma_0(N))$$ と書くが、その次元は $$\dim_\mathbb{C}\,\Omega^1(X_0(N))$$ に等しいことが知られている。
2.  **局所パラメータ** $$q$$\
    典型的には、例えば狭点 $$\infty$$ の近傍では $$z$$ を上半平面の変数として $$q = e^{2\pi i z}$$ を局所パラメータ（地元座標）とみなす。このときモジュラー形式 $$f(z)$$（あるいは対応する微分）は、次のような**べき級数**として書ける：

    $$
    f(z) = \sum_{n=0}^{\infty} a_n \, q^n,
    $$

    これはその狭点での**フーリエ展開**または $$q$$**-展開**と呼ばれる。解析的には、$$\Gamma_0(N)$$ 下での平行移動（格子平行移動）による周期性や成長条件と対応づけて理解できる。
3. $$q$$**-展開が重要な理由**
   * **算術的な係数**: フーリエ係数 $$a_n$$ はしばしば数体に属し、約数関数やフロベニウスの跡などを表すため、ガロワ表現に対応する重要な情報が含まれる。
   * **カスプ形式かどうか**: $$\infty$$ での消失（=定項項 $$a_0$$ が0）によって、狭点で消える**カスプ形式**かどうかが判定できる。
   * **変形（退化）**: モジュライ解釈では、狭点は退化（特異）したエリプティック曲線に相当する。$$q$$-展開は、そうした退化点近傍で「エリプティック曲線の族」がどのように開いていくかを表す。

### 11.2.2 モジュラー幾何における狭点

1. **狭点（cusp）の定義**\
   解析的な文脈では、**狭点**とは $$\Gamma_0(N)$$ が作用する有理境界点 $$\mathbb{Q}\cup\{\infty\}$$ の軌道のことを指す。具体的には、$$\alpha \in \mathbb{Q}\cup \{\infty\}$$ は、$$\Gamma_0(N)$$ の作用で同値な点としてみなされる。これら有限個の狭点を加えることで、$$\Gamma_0(N)\backslash \mathcal{H}$$ を**コンパクト化**し、コンパクトリーマン面（代数曲線）としてとらえることができる。
2. **モジュライ理論における解釈**\
   狭点はモジュライ問題の「境界」に対応し、**特異（ノーダル）のエリプティック曲線**が現れる退化の状況を表す。その際、位数 $$N$$ の部分群も同様に退化するが、それが整合的に「巡回部分群の退化」を伴う点として解釈される。
3. **例**
   * $$X_0(1) = X(1)$$: 古典的には、$$\mathrm{SL}_2(\mathbb{Z})\backslash \mathcal{H}$$ を狭点でコンパクト化したものが $$X(1)$$ で、これは $$\mathbb{P}^1$$ と同型で種数0になる。唯一の狭点は $$\infty$$（およびその $$\mathrm{SL}_2(\mathbb{Z})$$ 軌道）で、すべて同値類は1つにまとまる。
   * $$X_0(p)$$**（**$$p$$ **を素数）**: 狭点はいくつか存在し、$$\frac{a}{d}$$（$$d\mid p$$）などの有理数が対応する。具体的には、$$\Gamma_0(p)$$ で固定される行列を調べることで実際に分類できる。

***

## 11.3 ヘッケ代数を通じた算術とのつながり

モジュラー曲線には、**ヘッケ作用素（Hecke operator）と呼ばれる豊富な代数的エンドモルフィズムが備わっています。これらはモジュラー形式の空間や** $$X_0(N)$$ **のコホモロジー、さらにヤコビ多様体** $$J_0(N)$$ **に作用します。このとき、ヘッケ作用素はガロワ表現**との直接的な対応を与えるという点で非常に深い意味をもちます。事実、ヘッケ作用素はモジュラー形式とガロワ表現を繋ぐ「端子」として、現代数論やラングランズ・プログラムの基礎をなしているのです。

### 11.3.1 ヤコビ多様体 $$J_0(N)$$

1.  **定義と構成**\
    射影代数曲線 $$X$$ に対し、その**ヤコビ多様体** $$J$$ は「次数0の除法類（divisor class）」をパラメトライズするアーベル多様体として定義されます。具体的には

    $$
    J_0(N) \;=\; \mathrm{Pic}^0\bigl(X_0(N)\bigr) \;\cong\; \frac{\mathrm{Div}^0(X_0(N))}{\sim}
    $$

    であり、ここで $$\mathrm{Div}^0$$ は次数0の除法群、$$\sim$$ は線型同値を表す。同様に、解析的には

    $$
    J_0(N) \;\cong\; \bigl(H^0(X_0(N),\Omega^1)\bigr)^\vee \big/ H_1\bigl(X_0(N),\mathbb{Z}\bigr)
    $$

    と見なすことができる（双対空間と整数係数ホモロジー群で割る構造）。
2.  **ヘッケ作用素の** $$J_0(N)$$ **への作用**\
    素数 $$p$$（ただし $$p\nmid N$$）に対する**ヘッケ作用素** $$T_p$$ は、$$\mathrm{SL}_2(\mathbb{Z})$$ 内のある種の両側剰余類

    $$
    \Gamma_0(N)\begin{pmatrix} 1 & 0 \\ 0 & p \end{pmatrix}\Gamma_0(N)
    $$

    で定義されるが、これは $$X_0(N)$$ 上の被覆写像を通して除法に作用し、それに伴って線 bundle へも作用を及ぼすため、ヤコビ多様体 $$J_0(N)$$ へも自然に誘導される。また、$$H^1(X_0(N),\mathbb{Q})$$（あるいは1次ベッチコホモロジー）上への作用とも対応し、アイヒラー–志村同型によりモジュラー形式の固有値と密接に結びつく。
3. **意義**
   * $$J_0(N)$$ は種数 $$g(X_0(N))$$ に等しい次元をもつ**アーベル多様体**である。
   * ヘッケ作用素は、モジュラー形式空間 $$S_2(\Gamma_0(N))$$ に現れる**固有値**を全て「記憶」しており、算術的情報をエンコードしている。
   * $$\ell$$-進コホモロジーやトーショングループを調べることで、このアーベル多様体から得られるガロワ表現は、モジュラー形式に付随するヘッケ固有値の系と一致することがわかる。

### 11.3.2 アイヒラー–志村理論とガロワ表現

1.  **ヘッケ作用素**\
    素数 $$p \nmid N$$ に対する**ヘッケ作用素** $$T_p$$ は、

    $$
    T_p \;=\; \Gamma_0(N)\begin{pmatrix} 1 & 0 \\ 0 & p \end{pmatrix}\Gamma_0(N)
    $$

    という両側剰余類により定義される演算子で、モジュラー形式 $$f(z)$$ に作用するときは、古典的には

    $$
    T_p f(z) \;=\; p^{k-1}f(pz) \;+\; \sum_{r=0}^{p-1} f\!\Bigl(\frac{z+r}{p}\Bigr)
    $$

    （ここではウェイト $$k$$ の場合）など、$$\frac{z}{p}$$ や $$\frac{z+r}{p}$$ を通した和として表されることがよく知られている（ただしウェイト2のときはもう少し単純化される）。
2.  **アイヒラー–志村同型**\
    アイヒラー–志村の定理の一つの形は、$$X_0(N)$$ の一次コホモロジー（ベッチあるいは特異コホモロジー）が

    $$
    H^1\bigl(X_0(N), \mathbb{C}\bigr) \;\cong\; S_2(\Gamma_0(N)) \;\oplus\; \overline{S_2(\Gamma_0(N))},
    $$

    という分解を持ち、ヘッケ代数が両辺に整合的に作用することを述べる。つまり、$$X_0(N)$$ の幾何学的なコホモロジーは、古典的カスプ形式とその複素共役が支配しているというわけである。
3.  **固有形式に付随するガロワ表現**\
    正規化された固有形式 $$f \in S_2(\Gamma_0(N))$$（各 $$T_p$$ が固有値 $$a_p(f)$$ を与える）があるとき、そのフーリエ係数から2次元の $$\ell$$-進ガロワ表現

    $$
    \rho_f : \mathrm{Gal}(\overline{\mathbb{Q}}/\mathbb{Q}) \;\longrightarrow\; \mathrm{GL}_2(\overline{\mathbb{Q}}_\ell)
    $$

    が構成できる。これは素数 $$p\nmid N$$ に対して

    $$
    \mathrm{trace}\!\bigl(\rho_f(\mathrm{Frob}_p)\bigr) = a_p(f),\quad
      \det\!\bigl(\rho_f(\mathrm{Frob}_p)\bigr) = p^{k-1}\chi(p)
    $$

    を満たす（ここでは $$\Gamma_0(N)$$ の場合、ネーベンタイプ指標 $$\chi$$ は自明と考えてよい）。これらのガロワ表現は、ヘッケ作用素がもつ同じ固有値をフロベニウス元の跡として実現している、という意味で「ヘッケ代数を経由した対応」を示す。
4. **帰結とフェルマーの最終定理**
   * 「$$\mathbb{Q}$$ 上のエリプティック曲線」と「ウェイト2の新保形式」との対応こそが、いわゆる\*\*谷山–志村–ヴェイユの定理（モジュラー性定理）\*\*の内容である。
   * ワイルズのフェルマーの最終定理の証明は、ある種のガロワ表現（仮に $$(x^n + y^n = z^n)$$ の非自明解が存在すると想定したときに得られるもの）が実はモジュラーになることを示すことに帰着した。その証明では、$$X_0(N)$$ とそのヤコビ多様体 $$J_0(N)$$、そしてヘッケ代数の研究を通して、局所変形環とヘッケ環の同一性（いわゆる **“**$$R = T$$**”**）を示す手法が用いられている。

***

## 歴史的・概念的コメント

* **モジュライによる統合**: $$\Gamma_0(N)\backslash \mathcal{H}$$ を「位数 $$N$$ の巡回部分群をもつエリプティック曲線のモジュライ空間」と見る視点により、解析的対象（モジュラー形式）と代数幾何（エリプティック曲線）が深く結びついた。
* **ヤコビ多様体が架け橋に**: ヤコビ多様体 $$J_0(N)$$ は、幾何学的データ（除法、線バンドル）をまとめるだけでなく、**ヘッケ作用素**と**ガロワ表現**の対応を体現する場として機能する。
* **FLT への道**: モジュラー形式、ガロワ表現、これらの変形理論を統合して研究する流れが、ワイルズの「谷山–志村–ヴェイユ予想（半安定エリプティック曲線の場合）の証明」、ひいてはフェルマーの最終定理の解決へと続く道程となった。

***

## 計算例と演習問題

1. **小さな** $$N$$ **に対する** $$X_0(N)$$ **の種数**
   * **目的**: $$\mathrm{SL}_2(\mathbb{Z})$$ に対する $$\Gamma_0(N)$$ の指数や、楕円点（2-あるいは3-回回転で固定される点）および狭点の寄与を使い、$$g(X_0(N))$$ を計算する。$$N=11, 13, 14,\dots$$ あたりを実際に求めてみる。
   *   **ヒント**: 種数を求める古典的な公式の一例は

       $$
       g(X_0(N)) \;=\; 1 + \frac{\mu}{12} - \frac{e_2}{4} - \frac{e_3}{3} - \frac{c}{2},
       $$

       であり、$$\mu = [\mathrm{SL}_2(\mathbb{Z}):\Gamma_0(N)]$$、$$e_2, e_3, c$$ は、それぞれ2次回転点、3次回転点、狭点の本数を数える。
2. **アイゼンシュタイン級数の** $$q$$**-展開**
   * **課題**: 古典的なアイゼンシュタイン級数 $$E_2(z)$$, $$E_4(z)$$, $$E_6(z)$$ の $$q=e^{2\pi i z}$$ による展開を導く。
   *   **ヒント**:

       $$
       E_2(z) = 1 - 24\sum_{n=1}^{\infty} \sigma_1(n)\,q^n,\quad
         E_4(z) = 1 + 240\sum_{n=1}^{\infty} \sigma_3(n)\,q^n,\quad
         E_6(z) = 1 - 504\sum_{n=1}^{\infty} \sigma_5(n)\,q^n,
       $$

       などが代表的な例。ここで $$\sigma_k(n)$$ は $$n$$ の正の約数の $$k$$ 乗和を表す。
3. **ヘッケ作用素** $$T_p$$ **の作用**
   * **課題**: 小さな素数 $$p$$ を固定し、カスプ形式 $$f(z) = \sum_{n=1}^\infty a_n q^n$$ に $$T_p$$ を作用させたとき、$$T_p f$$ の $$q^n$$-係数が $$a_{pn}$$ と $$a_{n/p}$$（ただし $$p\nmid n$$ の場合は 0）を使って線形結合で表されることを示す。
4. $$X_0(N)$$ **上の除法を** $$J_0(N)$$ **の点へ関連付ける**
   * **目的**: $$X_0(N)$$ 上の次数0の除法 $$D = P - Q$$ を考え、その除法が $$\mathrm{Pic}^0(X_0(N))$$ 内の線バンドルに対応する具体的な構成を示す。これにより、幾何学的な「除法」の言葉が、ヤコビ多様体がパラメトライズする「線バンドル（直線束）」とどう対応するかを理解する。

***

### 結び

モジュラー曲線 $$X_0(N)$$（および $$X_1(N)$$, $$X(N)$$ といった変種）は、

* **モジュライ的解釈**（$$\Gamma_0(N)\backslash \mathcal{H}$$ を位数 $$N$$ の巡回部分群を伴うエリプティック曲線の空間と見る視点）、
* **狭点周りの** $$q$$**-展開**（退化点近傍での函数の振る舞いを解析する道具）、
* **ヘッケ代数の** $$J_0(N)$$ **への作用**（モジュラー形式・ガロワ表現との対応をもたらす仕組み）

という三つの柱を通じて、解析・幾何・算術を深く結びつける魅力的な対象です。これらを踏まえることで、**モジュラー性**や**アーベル多様体**の理論、ひいては**フェルマーの最終定理**への道筋がより明確になります。本書の後続の節では、これらをさらに踏み込み、局所表現を大域に持ち上げる理論や、形式間の合同を扱うテクニック、そして最終的に\*\*「$$R = T$$」\*\*手法によるワイルズの戦略を詳細に説明していきます。

***
