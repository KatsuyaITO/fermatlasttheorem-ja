# 第31節:スキーム論的モジュライの解釈

***

### 31. スキーム論的モジュライの解釈

#### 31.1 $$X_0(N)$$ のより深い関手的視点

**31.1.1 なぜスキーム論的（およびスタック論的）視点が重要か**

前の節では、$$X_0(N)$$ のような**モジュラー曲線**を、（複素）代数曲線（あるいはリーマン面）として定義しました。これは、「位数 $$N$$ の巡回部分群」を伴う楕円曲線をパラメータ付けする古典的な定義です。しかし、この定義は主に複素数体 $$\mathbf{C}$$ 上で考察されており、より一般の基底（例えば正の標数の体、数体の整数環、$$p$$-進環など）を扱いたい現代的な算術幾何の要請を満たしにくい面があります。

そこで活躍するのが、次の二つの幾何学的道具です。

1. **スキーム (Schemes)**\
   多項式環のスペクトルなどを用いて、任意の可換環上で「幾何学的対象」を定義・考察する枠組みです。たとえば $$\mathrm{Spec}(\mathbf{Z}_p)$$ や $$\mathrm{Spec}(\mathcal{O}_K)$$（$$K$$ は数体）上での幾何を記述でき、良いまたは悪い約化などの情報を一元的に扱えます。
2. **スタック (Stacks)**\
   スキームをさらに一般化した概念で、主に「モジュライ問題」を取り扱うために導入されました。スタックでは、単に“同型類”だけでなく、その背後にある「自己同型」や「同型射の族」をもきちんと記録することができます。とくに正標数下で楕円曲線が自己同型群を大きく持つ場合（超特異など）に、スタックが有効に機能します。

**直感的説明**

* 「スキーム」は、古典的な代数多様体を「もっと一般の基底環に対してスプレッドアウトした」ものと考えられます。たとえば、各素点で良い/悪い約化を持つ楕円曲線を統合的に把握するのに適しています。
* 「スタック」は、「スキームに記憶能力を持たせたもの」とイメージされることがあります。すなわち、あるファミリーが同型を介して一致する場合に、その同型を失わずに管理できるのがスタックの利点です。

**歴史的背景**\
モジュラー曲線やアーベル多様体など多くの古典的モジュライ空間が、本質的にはスタックとして捉えるべきであるという視点は、Deligne、Rapoport、Drinfeld などの先駆的研究によって確立されました。レベル構造・悪い約化・自己同型などの取り扱いが明確化されたことは、正標数下での超特異現象を含むさまざまな微妙な問題を解決に導きました。

**31.1.2 スキームとしての** $$X_0(N)$$

古典的には、$$X_0(N)$$ は次のデータによって定義されます。

* **対象 (Objects)**: $$(E, C)$$ という組で、$$E$$ は楕円曲線、$$C \subset E$$ は位数 $$N$$ の巡回部分群。
* **射 (Morphisms)**: 部分群構造を保つような組 $$(E,C)$$ の同型。

この定義をスキーム論で体系化するには、**モジュライ関手**を考えます。具体的には

$$
M_0(N) \colon (\mathrm{Schemes}/\mathbf{Z}[1/N]) \;\longrightarrow\; (\mathrm{Sets})
$$

という関手を定義し、$$\mathbf{Z}[1/N]$$-スキーム $$S$$ に対して、

* $$S$$ 上の楕円曲線 $$\mathcal{E} \to S$$（つまり各ファイバーが種数 1 の曲線となり、単位元を与える断面を持つ、滑らかかつ完備な族）、
* ランク $$N$$ の有限平坦部分群スキーム $$\mathcal{C} \subset \mathcal{E}$$（各ファイバーごとに $$\mathbf{Z}/N\mathbf{Z}$$ と同型になる巡回群）、

の**同型類**全体の集合を $$M_0(N)(S)$$ として定義するのです。

これに関して、Deligne–Rapoport らの一般論に基づく基本的な**定理**があります。

> **（定理：**$$M_0(N)$$ **の表現可能性）**\
> 上記のモジュライ関手 $$M_0(N)$$ は、$$\mathbf{Z}[1/N]$$ 上の（細かい意味での）モジュライスキーム $$X_0(N)$$ によって表現される。\
> すなわち、$$\mathbf{Z}[1/N]$$ 上の任意のスキーム $$S$$ に対し、
>
> $$
> \mathrm{Hom}_{\mathbf{Z}[1/N]}\bigl(S, X_0(N)\bigr) \;\cong\; M_0(N)(S)
> $$
>
> が成立する。

この表現可能性は強力な主張で、「任意の基底 $$S$$ に対して、そこから $$X_0(N)$$ への射を取ることと、$$(\mathcal{E}, \mathcal{C})$$ の族を取ることが等価である」ことを意味します。さらに、**同型射**を「忘れない」形で捉えたモジュライスタック $$\mathcal{X}_0(N)$$ を考えるときもあり、それによって自己同型の情報まで保持することができます。

**一般の基底上で重要となる理由**

* $$N$$ と素数 $$p$$ が互いに素なとき、従来の複素（あるいは標数 0 の）理論がそのまま現れます。
* 特に $$p \mid N$$ の場合には、部分群スキームがエタール型になるか、あるいは乗法的になるかなど、正標数特有の現象が現れます。有限平坦群スキームの理論によって、こうした振る舞いをスキーム論的に取り扱うことができます。

**31.1.3 モジュラー曲線におけるスタックとスキーム**

$$X_0(N)$$ は確かにスキームとして定義できますが、実は「粗モジュライスキーム (coarse moduli scheme)」としての姿にすぎない場合もあります。より正確な対象は、モジュライスタック $$\mathcal{X}_0(N)$$ です。そこでは、とりわけ正標数における自己同型を追跡できます。

* **正標数** $$p$$ **での自己同型**: 超特異楕円曲線など自己同型群が大きくなる場合、スキームとして同型類だけを扱うと見えなくなる「追加の対称性」が存在します。スタックならばそれらを保持できます。
* **普遍族 (universal family)**: スタック $$\mathcal{X}_0(N)$$ 上には、「普遍楕円曲線」$$\mathcal{E}_{\mathrm{univ}} \to \mathcal{X}_0(N)$$ と「普遍的な巡回部分群」$$\mathcal{C}_{\mathrm{univ}}$$ が存在し、これは「任意の射 $$S \to \mathcal{X}_0(N)$$ に対して引き戻すと $$(\mathcal{E}, \mathcal{C})$$ の族を再現する」という意味で真の普遍対象となっています。

これらの構成をコンパクト化したり、悪い素点での振る舞いを含めて体系立てたものとして、**Deligne–Rapoport模型** などの手法があります。これらは 1970 年代に大きく進展し、**フェルマーの最終定理**に関連する証明など、多くの数論的深結果で重要な役割を果たしてきました。

***

#### 31.2 変形理論と交点理論への応用

**31.2.1 楕円曲線の変形理論**

現代の数論では**ガロア表現の変形理論**が大きな注目を集めていますが、楕円曲線自体の変形理論も同様に重要です。$$X_0(N)$$ を（スタックとして）モジュライ空間とみなすことで、楕円曲線とレベル構造の変動を一望できます。

**重要なポイント**

1. **普遍変形 (universal deformation)**\
   ガロア表現や楕円曲線などのオブジェクトに対して、「普遍」あるいは「準普遍 (versal)」変形環を考え、そのオブジェクトがどのように変形するかをパラメータ付ける手法があります。
2. **ネロン模型 (Néron model) と悪い約化**\
   悪い約化が起こる素点では、半安定化などの手続きを経て楕円曲線の振る舞いを調べます。モジュライスタック $$\mathcal{X}_0(N)$$ 上の普遍族は、こうした局所情報を全体像の中で捉えることができます。
3. **フェルマーの最終定理との関係**
   * 有理数体上の楕円曲線は、2 次元の $$\ell$$-進ガロア表現を伴います。
   * レベル構造を課すことは、剰余系や惰性群作用に関する条件を課すことと対応し、これが**局所-大域原理**的に全体へ影響を及ぼします。
   * $$\mathbf{Z}_p$$ などの環スペクトル上でこのモジュライ問題を考えることは、素点ごとの条件を幾何学的に統合し、世界的な（数体全体の）構造を捉える道具となります。

**線バンドルとモジュラー形式**\
代数幾何の観点では、重み $$k$$ のモジュラー形式は、（コンパクト化された）モジュライスタック $$\mathcal{X}_0(N)$$ 上の「ホッジバンドル」$$\omega$$ の $$k$$ 乗 $$\omega^k$$ の大域切断として理解できます。解析的な「保型形式」の概念を、純粋に幾何学的な「線束の切断」に置き換えることで、コホモロジーや交点理論など代数幾何の強力な道具立てを用いることができます。

**31.2.2 モジュラー曲面（曲線）の交点理論**

交点理論は、与えられた空間上の部分多様体（または因子）がどのように交わるかを調べる分野です。特にモジュラー曲面（本節では次元 1 のモジュラー“曲線”を含む意味でも用います）において、交点理論は算術幾何学で中心的役割を担ってきました。

1. **高さのペアリング (Height pairing)**
   * 楕円曲線の**標準高さ**は、しばしばモジュラー曲面上の因子の交点数と関係付けられます。これは **Birch–Swinnerton-Dyer 予想**などの解析で鍵となる方法です。
2. **Arakelov 理論**
   * $$\mathrm{Spec}(\mathbf{Z})$$ 上での「算術曲面」に対する交点理論を精緻化した枠組みで、無限素点（アルキメデス素点）での寄与まで考慮する理論です。
   * 代数点の高さと交点数が結び付けられるなど、世界的な数論問題の解決において大きな力を発揮します。
3. **コンパクト化とカスプ（尖点）**
   * 交点理論を応用する際は、通常 $$X_0(N)$$ を尖点（カスプ）を加えてコンパクト化した空間上で作業します。尖点に対応する因子も交点計算に影響を与え、古典的には **カスプ形式**と **アイゼンシュタイン級数**の間の種々の公式に関わります。

**計算の道具**

* **Chow 群・Chern 類**: スキーム論的な交点理論では、Chow 環（あるいは解析的にはコホモロジー環）が主な舞台になります。ホッジバンドル $$\omega$$ の Chern 類は、モジュラー空間上での因子の交点計算に頻出する重要な道具です。
* **Fulton の交点理論**: W. Fulton による交点理論は、特異多様体やスタックにも適用可能な包括的枠組みを与えます。モジュライスタック上の交点数を扱う現代的研究の多くは、この理論を基盤としています。

**31.2.3 計算例と歴史的補足**

* **例：低次レベルのモジュラー曲線**\
  たとえば $$X_0(2)$$ や $$X_0(3)$$ のような小さな場合は、$$\mathbf{Z}[1/N]$$ 上の具体的な方程式や普遍族を（ある程度）書き下すことができ、尖点や特別点に対応する因子を明示的に追うことで、交点数を“手計算”することも不可能ではありません。
* **Igusa 曲線と Shimura 曲線**
  * **Igusa 曲線**: 種数 2 の曲線でのレベル構造を扱う高次元版で、同様にモジュライ理論によって特徴付けられます。
  * **Shimura 曲線**: さらに一般化したもので、PEL 型のエンドモルフィズムをもつアーベル多様体などをパラメータ付けます。モジュラー曲線の考え方を大域的に拡張した例といえます。
* **歴史的発展**\
  モジュラー空間上の交点理論は 1970～1980 年代に盛んに研究され、**Birch–Swinnerton-Dyer 予想**や **岩澤理論**、そして **フェルマーの最終定理**の証明など、深い算術的課題に挑む際の有力な手段となってきました。1990 年代に入ってワイルズによるフェルマーの最終定理証明が完成すると、変形理論・モジュラー曲線・交点理論といった要素が現代数論の基盤として統合されるに至りました。

***

### まとめと今後の展望

本節では、$$X_0(N)$$ を例に、「スキーム論的・スタック論的」な枠組みでモジュラー曲線を扱う意義を見てきました。主なポイントは次のとおりです。

1. **スキーム**: $$\mathbf{Z}[1/N]$$ やその他の基底上で古典的モジュライを統一的に扱う強力な手法を与える。
2. **スタック**: 同型射や正標数における自己同型を失わずにモジュライ問題を記述できる、より精密な理論を提供する。
3. **変形理論・交点理論**: こうした豊かなモジュライ空間の構造を利用し、楕円曲線やガロア表現の変形、算術曲面上の交点数などを統合的に研究することが、現代数論の数々の難問（フェルマーの最終定理を含む）に対応する基盤となっている。

次の節以降では、このモジュライの視点をさらに進めて、**Selmer 群**や **変形環**、そして **(R = T)** という手法（ガロア表現とHecke代数を結び付ける同型）がどのように展開していくのかを扱います。幾何と算術が見事に交錯する現代数論の核心に、これらのモジュライ理論が欠かせない位置を占めているのです。
