# 第26節:Hecke代数

Hecke 代数は、モジュラー形式の空間上で作用する一連の「Hecke 作用素」を統一的に扱う枠組みを提供する。これらの Hecke 作用素は、モジュラー形式に内在する重要な算術的特徴を捉え、モジュラー形式とガロア表現をつなぐ基本的な架け橋となっている。

歴史的に見ると、Erich Hecke は 20 世紀初頭にこれらの作用素を導入し、_L_-函数との関連や乗法的な性質を明らかにした。その後の研究により、Hecke 代数内部の「極大イデアル」で局所化すると、個々の固有形式（同時固有ベクトル）が分離できることが示された。これらの固有形式のフーリエ係数には深い算術データが含まれ、ガロア表現を付随させることが可能になる。これは最終的に Wiles の Fermat の最終定理の証明へと至る流れの中核部分をなす。

本節では以下を扱う:

* **定義**：ある合同部分群に付随する Hecke 代数の定義
* **作用**：Hecke 作用素がモジュラー形式にどのように作用し、その固有値がフーリエ展開にどう現れるか
* **固有形式と極大イデアル**：固有形式が Hecke 代数の極大イデアルを生み出す仕組み
* **局所化とガロア表現**：それらの極大イデアルで局所化することで、ガロア表現との対応をどのように得るか

***

## 26.1 生成と基本性質

### 26.1.1 合同部分群からの Hecke 代数の構成

#### 定義：合同部分群

$$\Gamma \subset SL_2(\mathbb{Z})$$ が **合同部分群 (congruence subgroup)** であるとは、ある整数 $$N$$ に対して

$$
\Gamma(N) \;=\; \{\gamma \in SL_2(\mathbb{Z}) : \gamma \equiv I \pmod{N}\}
$$

を含む部分群であることをいう。よく使われる例として以下がある:

* $$\Gamma_0(N)$$: 行列 $$\begin{pmatrix} a & b \\ c & d \end{pmatrix}$$ で $$c \equiv 0 \pmod{N}$$ となるもの全体
* $$\Gamma_1(N)$$: $$\Gamma_0(N)$$ のうち、さらに $$a \equiv d \equiv 1 \pmod{N}$$ となるもの
* $$\Gamma(N)$$: 行列が恒等行列に合同（同じ剰余）になるもの ($$\gamma \equiv I \pmod{N}$$)

本節では具体性のために $$\Gamma_0(N)$$ を主に扱う。

***

#### 定義：重み $$k$$ のモジュラー形式

合同部分群 $$\Gamma$$ に対する整数重み $$k$$ の **モジュラー形式** とは、上半平面 $$\mathbb{H}$$ 上で定義される正則函数 $$f : \mathbb{H} \to \mathbb{C}$$ で、以下を満たすものである:

1.  変換則

    $$
    f\!\Bigl(\frac{az + b}{cz + d}\Bigr)
      \;=\;
      (cz + d)^{-k}\, f(z)
      \quad\text{（すべての } \begin{pmatrix} a & b \\ c & d\end{pmatrix} \in \Gamma \text{ について）}
    $$
2. カスプでの正則性\
   すべてのカスプ（無限遠点含む）におけるフーリエ展開が極を持たない（定数項を含めた冪級数展開が正則）こと。

このような形式のなす空間を $$M_k(\Gamma)$$ と書く。さらに **カスプ形式** とは、各カスプで定数項が消える（ゼロ）という追加条件を満たすモジュラー形式であり、その部分空間を $$S_k(\Gamma)$$ と表す。

***

### Hecke 作用素とその代数

**直観的イメージ**\
Hecke 作用素（$$T_n$$ と書く）は、モジュラー形式 $$f$$ を「ある種のコセット全体」にわたって平均化するような演算子と考えることができる。幾何学的には、整数 $$n$$ に付随する行列を通して、$$f$$ の値を対応する点に「拡散」させる作用を持っており、そのフーリエ係数の振る舞いに重要な算術的情報が反映される。

具体的に、$$p$$ が素数のときの $$T_p$$ は以下のように定義できる:

$$
T_p f(z) \;=\;
    \frac{1}{p} \sum_{x=0}^{p-1} f\!\Bigl(\tfrac{z+x}{p}\Bigr)
    \;+\;
    \frac{1}{p}\, f(p z).
$$

これは、$$f$$ の値を $$\frac{1}{p}$$ ずつシフトした点たちで合算しつつ、$$f(pz)$$ も取り込む操作であり、各フーリエ係数に算術的な構造を与える。

***

#### 形式的な枠組み

1. **合同部分群**\
   $$\Gamma_0(N)\subset SL_2(\mathbb{Z})$$ を固定し、そこに付随する重み $$k$$ のモジュラー形式の空間 $$M_k(\Gamma_0(N))$$ を考える。
2.  **Hecke 作用素** $$T_n$$\
    整数 $$n \ge 1$$ ごとに作用素 $$T_n$$ が定義される。これは

    $$
    T_n
      \;=\;
      \Gamma_0(N)\,
      \begin{pmatrix} 1 & 0 \\ 0 & n \end{pmatrix}\,
      \Gamma_0(N)
    $$

    と呼ばれるダブルコセットに基づく群環の元であり、それが $$M_k(\Gamma_0(N))$$ 上の自己準同型として具現化する。実際には、このダブルコセットがもたらす作用を「合計平均」をとるような形で実装することで、$$f$$ を再び同じ空間内に写す。
3. **環構造**\
   こうして得られる作用素たち $$\{T_n\}_{n \ge 1}$$ は可換な環（単位元 $$T_1 = \mathrm{id}$$ を含む）を成す。場合によってはさらにダイヤモンド作用素 $$\langle d \rangle$$（$$\Gamma_0(N)$$ に付随する予想単数群の作用）を含めるが、ここでは主に $$T_n$$ を強調する。
4.  **Hecke 代数**\
    **Hecke 代数** $$\mathbb{T} = \mathbb{T}(\Gamma_0(N); k)$$ とは、すべての Hecke 作用素によって生成される $$\mathrm{End}_{\mathbb{C}}(M_k(\Gamma_0(N)))$$ の部分環である:

    $$
    \mathbb{T} \;=\;
        \Bigl\langle\, T_1, T_2, \dots, T_n, \dots \Bigr\rangle.
    $$

    この代数が **可換** であることは、これらの作用素間の深い乗法的関係を反映しており、後述する同時固有ベクトル（固有形式）を考える基盤となる。

***

#### 主な性質

1.  **Hecke 作用素の可換性**\
    基本的な定理として、すべての $$m,n$$ に対して $$T_m$$ と $$T_n$$ は可換である。また、

    $$
    T_m T_n
      \;=\;
      \sum_{d\,\mid\,\gcd(m,n)}
        d^{k-1}\, T_{\frac{mn}{d^2}}
    $$

    のような積の公式（ダイヤモンド作用素などが含まれる場合は修正が入る）が成り立つ。可換性があるため、すべての $$T_n$$ を同時対角化でき、その固有ベクトルが固有形式となる。
2. **算術的フレーバー**\
   幾何学的には、$$T_n$$ はモジュラー曲線 $$X_0(N)$$ 上の対応 (correspondence) から生じる作用であり、特に素数 $$p$$ ごとの局所的な算術情報が反映される。この幾何と算術の相互作用が後のガロア表現構成において重要となる。
3. $$L$$**-系列との関係**\
   固有形式の固有値は、対応する $$L$$-函数の局所因子に一致することが知られており、Hecke 代数はフーリエ系列（解析的側面）とガロア表現・算術（代数的側面）を結び付ける役割を果たす。

***

### 26.1.2 モジュラー形式とフーリエ係数との関係

$$f \in M_k(\Gamma_0(N))$$ を考え、標準的なカスプ（$$\infty$$）におけるフーリエ展開を

$$
f(z) \;=\; \sum_{n=0}^{\infty} a_n \, q^n
  \quad (\text{ここで } q = e^{2\pi i z})
$$

と書く。もし $$f$$ がすべての Hecke 作用素 $$T_n$$ の同時固有ベクトル（＝固有形式）であるなら、その固有値を $$\{a_n\}$$ で表すことができる。特に「正規化」を行い $$a_1 = 1$$ とすると、$$T_n$$ の固有値はフーリエ係数 $$a_n$$ と一致する。

**ポイント:**

1. **Hecke 固有値の関係式**\
   $$T_n f = a_n f$$ を満たす。特に素数 $$p$$ に対しては、$$T_p$$ の固有値 $$a_p$$ がフーリエ展開の $$q^p$$ の係数に一致し、算術的に大きな意味を持つ。
2. **乗法的性質**\
   $$\gcd(m,n) = 1$$ のとき、$$a_{mn} = a_m a_n$$ が成り立つ。これは可換な Hecke 作用素が同時対角化される結果とも対応し、$$\{a_n\}$$ が数論的に「乗法的」な函数のように振る舞うことを示唆する。
3.  $$L$$**-系列への応用**\
    固有形式 $$f$$ の係数 $$\{a_n\}$$ を用いて

    $$
    L(f, s) \;=\; \sum_{n=1}^\infty \frac{a_n}{n^s}
    $$

    と定義すると、こうした $$L$$-級数はリーマンの $$\zeta$$-函数に類似した（しかしより一般的な）解析的性質や、自己双対性を示すような変換則を持つ。これにより解析と算術の間の更なる対応が深まる。

***

#### 例：$$T_2$$ の作用

具体例として、重み $$k$$ の形式 $$f$$ に対する $$T_2$$ の作用を見てみよう。定義から

$$
T_2 f(z)
  \;=\;
    \frac{1}{2}
      \sum_{x=0}^{1}
        f\!\Bigl(\tfrac{z + x}{2}\Bigr)
    \;+\;
    \frac{1}{2}
      f(2z)
$$

となる。もし $$f(z) = \sum_{n=0}^{\infty} a_n \, e^{2\pi i n z}$$ と展開すると、それぞれの項がどのように係数 $$\{a_n\}$$ を組み合わせるかを計算でき、$$f$$ が固有形式ならば、その固有値 $$a_2$$ として一意に決まる。

***

## 26.2 固有形式、局所化、そしてガロア作用

### 26.2.1 ガロア表現に対応する極大イデアルへの局所化

Hecke 代数が持つ際立った特徴の一つは、「固有形式」に対応する極大イデアルを取り出して局所化することで、ある特定の固有形式を「切り取る」ことができるという点である。

#### 固有形式から極大イデアルへ

すべての $$T_n$$ に対する同時固有形式 $$f$$ を一つ fix すると、次のように環準同型を定義できる:

$$
\phi_f : \mathbb{T} \;\longrightarrow\; \mathbb{C},
  \quad
  T_n \;\mapsto\; a_n.
$$

これは _可換環の準同型_ となり、その核

$$
\mathfrak{m}_f \;=\; \ker(\phi_f)
$$

は $$\mathbb{T}$$ の極大イデアルを与える。直観的には、$$\mathfrak{m}_f$$ は「$$T_n$$ の固有値が $$a_n$$ である」という条件を満たすイデアルとして理解できる。実際の研究では、$$\mathbb{Z}$$-係数や数体係数での整整数論的取り扱いが重要になるが、基本的なアイデアは同様である。

***

#### $$\mathfrak{m}_f$$ での局所化

Hecke 代数 $$\mathbb{T}$$ において、$$\mathfrak{m}_f$$ に含まれない元を可逆（単元）とみなす「局所化 (localization)」

$$
\mathbb{T}_{\mathfrak{m}_f}
  \;=\;
  \Bigl\{
    \frac{x}{s} \,\middle|\,
    x,\,s \in \mathbb{T}, \; s \notin \mathfrak{m}_f
  \Bigr\}
$$

を考えると、これによって「$$f$$ に対応する成分」にフォーカスすることができる。しばしばこの局所化された環は局所環 (local ring) となり、さらに場合によっては Gorenstein 環の構造をもつ。このような性質は変形理論（deformation theory）の手法と組み合わせるうえで非常に強力である。

***

#### ガロア表現の付随

現代数論の中心的な結果として、重み $$k \ge 2$$ の **新形式 (newform)** $$f$$ には、2 次元の $$p$$**-進ガロア表現**

$$
\rho_f : \mathrm{Gal}\bigl(\overline{\mathbb{Q}} / \mathbb{Q}\bigr)
    \;\longrightarrow\; GL_2(\overline{\mathbb{Q}}_p)
$$

が付随する。ここで $$N$$ は（例として $$\Gamma_0(N)$$ に関連する）レベル、$$p$$ は表現をとる底となる素数である。素数 $$\ell$$ で $$\ell \nmid Np$$ のとき、

$$
\mathrm{tr}\bigl(\rho_f(\mathrm{Frob}_\ell)\bigr) = a_\ell,
  \quad
  \det\bigl(\rho_f(\mathrm{Frob}_\ell)\bigr) = \ell^{k-1}\chi(\ell)
$$

が成り立つ。ここで $$\mathrm{Frob}_\ell$$ は $$\ell$$ のフロベニウス元、$$\chi(\ell)$$ は対応するネーベンタタイプ（Nebentypus）指標を表す。要するに、$$T_\ell$$ の固有値 $$a_\ell$$ がガロア表現のフロベニウス元のトレースに一致し、行列式は $$\ell^{k-1}\chi(\ell)$$ となる。従って、Hecke 代数を $$\mathfrak{m}_f$$ で局所化することによって、ちょうど $$ho_f$$ が捉える算術情報に対応づけることができる。

こうした考え方は、より進んだ文脈（例えば、Fermat の最終定理の証明に登場する）において、$$R = \mathbb{T}$$ 型の定理を構築する際に中心的な役割を果たす。ここで $$R$$ はある既約表現の変形をパラメトライズする _普遍変形環_ で、$$\mathbb{T}_{\mathfrak{m}_f}$$ と同一視できることが示される。

***

### 26.2.2 固有値をガロアデータと結びつける具体的手法

1. **フロベニウス元と Hecke 作用素**\
   $$\ell \nmid N$$ のとき、Hecke 作用素 $$T_\ell$$ はガロア表現 $$ho_f$$ における $$\mathrm{Frob}_\ell$$ のトレースに対応する。したがって、各素数ごとの局所情報（フロベニウス作用）を固有値 $$\{a_\ell\}$$ が反映している。
2. **極大イデアルの同定**\
   $$\mathfrak{m}_f$$ は、例えば $$\{T_\ell - a_\ell\}$$ や Atkin–Lehner 作用素、ダイヤモンド作用素などの関係子によって生成されるイデアルとして定義される。これにより、「$$f$$ の係数が与える算術条件」をアルgebra 的に取り込んでいる。
3.  **変形環との比較**\
    高度な証明では、しばしば

    $$
    R_{\mathfrak{m}_f} \; \longleftrightarrow \; \mathbb{T}_{\mathfrak{m}_f}
    $$

    という同型を示し、ある既約表現の「持ち上げ」（リフト）をパラメトライズする変形環 $$R_{\mathfrak{m}_f}$$ と局所化した Hecke 代数 $$\mathbb{T}_{\mathfrak{m}_f}$$ を厳密に一致させる。これがガロア表現のモジュラー性（Taniyama–Shimura–Weil 予想）の証明などの鍵となる、いわゆる「$$\mathbf{R} = \mathbf{T}$$」手法である。

***

#### 例：Ramanujan の $$\Delta$$-函数

**Ramanujan の** $$\Delta$$**-函数**（重み 12、群 $$SL_2(\mathbb{Z})$$）は

$$
\Delta(z)
  \;=\;
  q \,\prod_{n=1}^\infty(1-q^n)^{24}
  \;=\;
  \sum_{n=1}^\infty \tau(n)\, q^n
$$

で定義される。これは $$T_p$$ に対して固有値 $$\tau(p)$$ を持つ固有形式として知られている（$$\tau$$ は Ramanujan のタウ函数）。

* $$\tau(p)$$ は Ramanujan のタウ函数として有名。
* Deligne による Weil 予想の特別場合の証明から、$$\lvert \tau(p)\rvert \le 2\,p^{11/2}$$ が成り立ち、一般の尖点形式のフーリエ係数に対する境界（Ramanujan–Petersson 予想）と整合する。
*   付随するガロア表現 $$ho_\Delta$$ については、

    $$
    \mathrm{tr}\bigl(\rho_\Delta(\mathrm{Frob}_p)\bigr) = \tau(p),
      \quad
      \det\bigl(\rho_\Delta(\mathrm{Frob}_p)\bigr) = p^{11}
    $$

    が成立する。
* 重み 12 のモジュラー形式全体の Hecke 代数において、$$\{T_p - \tau(p)\}$$（すべての素数 $$p$$ に対して）の生成するイデアルで局所化すると、この $$\Delta$$-函数に対応するガロア表現だけを「切り出す」ことができる。

このように、1 つの固有形式のフーリエ係数が、膨大な算術情報を秘めており、Hecke 代数の極大イデアルを介してそれを環論的に捉えることが可能である。

***

## まとめと今後の展開

**Hecke 代数** $$\mathbb{T}$$ は、モジュラー形式上のすべての Hecke 作用素 $$T_n$$ をまとめた可換環であり、その内部構造は算術的にも非常に豊かである。

* **固有形式** $$\leftrightarrow$$ **極大イデアル**\
  固有形式 $$f$$ ごとに、Hecke 代数内でそれに対応する極大イデアル $$\mathfrak{m}_f$$ が一意に定まる。局所化 $$\mathbb{T}_{\mathfrak{m}_f}$$ を考えると、$$f$$ がもつ算術情報にフォーカスできる。
* **ガロア表現との対応**\
  固有形式の Hecke 固有値は、ガロア表現 $$ho_f$$ のフロベニウス元に対するトレースや行列式の情報に対応する。これによってモジュラー形式とガロア表現が密接に結びつけられる。
* $$(R = T)$$ **手法**\
  局所化した Hecke 代数 $$\mathbb{T}_{\mathfrak{m}_f}$$ を、残余表現の変形環 $$R_{\mathfrak{m}_f}$$ と対比・同一視することで、ガロア表現の変形がすべてモジュラー形式に由来することを示す強力な方法が得られる。これが Wiles の半安定楕円曲線のモジュラー性（ひいては Fermat の最終定理）証明の核心である。

次節以降では、これらの局所性・大域性をめぐる Hecke 代数の性質をさらに詳しく掘り下げ、**変形理論** や「$$(R = T)$$ の定理」の具体的な証明スキームへと話を進める。最終的には、あらゆる「適切な」ガロア表現がモジュラー形式から生じることを示すという大目標があり、それが Taniyama–Shimura–Weil 予想を通じて Fermat の最終定理を導く最終段階となる。
