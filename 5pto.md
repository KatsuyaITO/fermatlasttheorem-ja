# 第5節:p進数と解析

古典的な数論では、整数や有理数の「大きさ」を測るときに、通常の（アルキメデス的な）絶対値を使って実数 $$\mathbb{R}$$ や実解析へと進むのが一般的です。しかし、ある素数 $$p$$ にまつわる問題（たとえば、$$p$$ に関する可除性や $$p$$ を法とする解の存在など）を扱う際には、数がどのくらい「$$p$$ の冪で割り切れるか」をもとに近さを測るほうが有効となる場合が多々あります。この発想が\*$$p$$-進絶対値\* $$|\cdot|_p$$ およびその完備化 $$\mathbb{Q}_p$$ を導きます。これらの $$p$$-進数と $$p$$-進解析は、ヘンゼルの補題、局所大域原理、$$p$$-進 $$L$$-関数といった強力な道具の基盤となる、現代数論の中心的存在です。

歴史的には、$$\mathbb{Q}_p$$ は 20 世紀初頭にクルト・ヘンゼル（Kurt Hensel）によって考案されました。ちょうど $$\mathbb{R}$$ が通常の距離に関して $$\mathbb{Q}$$ を完備化したものとして得られるように、同様の手法を素数 $$p$$ に対応する別の距離で行えば、$$\mathbb{Q}$$ の新たな完備化が得られることをヘンゼルは見抜いたのです。この $$p$$-進完備化は、ある種の算術的問題を単純化するだけでなく、代数幾何やディオファントス方程式、ガロワ表現の深い構造を解明する手段ともなり、最終的にはフェルマーの最終定理の証明にも重要な役割を果たしました。

***

## 5.1. $$\mathbb{Q}_p$$ の定義と付値

まずは、$$\mathbb{Q}$$ 上の $$p$$-進付値や絶対値を定義し、そこからどのように $$\mathbb{Q}$$ を完備化して $$\mathbb{Q}_p$$ を得るかを概説します。

### 5.1.1. 非アルキメデス付値と計量

#### 定義 5.1 ($$p$$-進付値)

固定した素数 $$p$$ に対し、0 でない有理数 $$x$$ を分解して

$$
x \;=\; p^k \,\frac{a}{b},
\quad 
\text{ただし } a, b \in \mathbb{Z}, \; p \nmid a, \; p \nmid b
$$

と表せるとき、$$p$$_-進付値_ $$v_p(x)$$ を

$$
v_p(x) \;=\; k
$$

と定義する。0 の付値は便宜上 $$+\infty$$ とする。

* $$v_p(x) > 0$$ ならば、$$x$$ は $$p$$ で割り切れることを意味する。
* $$v_p(x) < 0$$ ならば、$$x$$ は $$1/p$$ の因子を含む（すなわち分母が $$p$$ を含む）ことを意味する。
* $$v_p(x)$$ が大きいほど、$$x$$ は $$p$$ の冪で「大きく」割り切れる。

#### 定義 5.2 ($$p$$-進絶対値)

上記の付値に伴い、有理数 $$x$$ に対して\*$$p$$-進絶対値\* $$|x|_p$$ を

$$
|x|_p \;=\; p^{-\,v_p(x)}
$$

と定義する。直感的には、「$$p$$ で割り切れれば割り切れるほど」$$|x|_p$$ は小さくなる。

**通常の絶対値との大きな違い**\
通常（アルキメデス）的な絶対値では $$|p| = p$$ だが、$$p$$-進絶対値では $$|p|_p = p^{-1}$$ となる（なぜなら $$v_p(p) = 1$$ だから）。この「大きさの逆転」が、$$p$$-進幾何が実や複素幾何と大きく異なることを最初に感じさせるポイントである。

#### 定理 5.3 (非アルキメデス性)

$$p$$-進絶対値 $$|\cdot|_p$$ &#x306F;_&#x975E;アルキメデス的三角不等&#x5F0F;_&#x3092;満たす：

$$
|x + y|_p \;\le\; \max\bigl(|x|_p,\; |y|_p\bigr)
\quad 
\forall x,y.
$$

特に、$$|x|_p \neq |y|_p$$ のときには

$$
|x + y|_p
\;=\; 
\max\bigl(|x|_p,\; |y|_p\bigr)
$$

が成立する。これは通常の三角不等式（$$|x+y|\le |x| + |y|$$）よりも強い制限であり、解析的に驚くべき現象をもたらす。一例として、付値の異なる 2 つの数を足しても、その和の付値は「大きいほう」と同じになる。

#### 定義 5.4 ($$p$$-進距離)

$$p$$-進絶対値を使って、$$\mathbb{Q}$$ 上に距離関数を

$$
d_p(x,y)
\;=\;
|x - y|_p
$$

と定義する。列 $$(x_n)$$ が $$p$$_-進的コーシー列_ であるとは、任意の $$\epsilon>0$$ に対してある $$N$$ が存在し、すべての $$m,n \ge N$$ について

$$
|x_n - x_m|_p < \epsilon
$$

が成り立つことをいう。同値な言い方をすると（離散的な付値の性質により）、$$|x_n - x_m|_p$$ が任意に小さくなる、すなわち大きな冪の $$p$$ で割り切れるようになる、ということである。ここでの「近い」とは、$$p$$ の高い冪で差が割り切れるという意味だ。

**例 5.1**

*   $$|45|_3$$ を求める。まず $$45$$ を 3 の冪で因数分解すると、$$45 = 3^2 \cdot 5$$。よって $$v_3(45) = 2$$ なので、

    $$
    |45|_3 = 3^{-2} = \tfrac{1}{9}.
    $$
*   $$|2|_5$$ を求める。$$5$$ は 2 を割り切らないので $$v_5(2) = 0$$。よって

    $$
    |2|_5 = 5^{-0} = 1.
    $$

### 5.1.2. $$\mathbb{Q}_p$$ の構成

ちょうど $$\mathbb{R}$$ が通常の距離で $$\mathbb{Q}$$ を完備化したものであるように、$$p$$-進距離 $$d_p$$ で $$\mathbb{Q}$$ を完備化すると $$\mathbb{Q}_p$$ が得られる。

#### 定義 5.5 (完備化)

$$p$$_-進数体_ $$\mathbb{Q}_p$$ は、

$$$
\mathbb{Q}_p 
\;=\; 
\Bigl\{
  \text{$$p$$-進的コーシー列の全体の同値類}
\Bigr\}
$$$

によって定義される。ここで、2 つのコーシー列が同値とは、それらの差が $$p$$-進的に 0 に収束することをいう。直感的には、$$\mathbb{Q}_p$$ の各元は、有理数列が $$\bmod\, p^k$$ で一致しつづけて限りなく「近づいていく」という極限（の形式的同値類）とみなせる。

**直感**: $$\mathbb{R}$$ では、極限とは実数直線上で区間を絞り込んでいくイメージだが、$$\mathbb{Q}_p$$ では基数 $$p$$ の展開において「下位桁がどこまでも一致していく」ことが極限を決める。

***

## 5.2. ヘンゼルの補題と解の $$p$$-進的リフティング

$$p$$-進整数の強力な応用の 1 つに、_ヘンゼルの補題 (Hensel’s Lemma)_ と呼ばれる手法がある。これは、多項式の合同式の解を $$\bmod\, p$$ から $$\bmod\, p^n$$（任意の $$n$$）へ、さらに $$\mathbb{Q}_p$$ の中の解へと「引き上げる (lift)」ことを可能にするものである。

### 定理 5.6 (ヘンゼルの補題・単純形)

整数係数の多項式 $$f(x)$$ が与えられたとき、ある整数 $$a$$ が次の条件をみたすとする：

$$
f(a)\,\equiv\, 0 \pmod{p}
\quad\text{かつ}\quad
f'(a)\,\not\equiv\, 0 \pmod{p}.
$$

このとき：

1. $$a$$ と合同 $$\bmod\, p$$ である整数 $$a_1$$ がただ一つ存在し、かつ $$f(a_1) \equiv 0 \pmod{p^2}$$ をみたす。
2. この過程を繰り返すことで、$$\bmod\, p^3, p^4, \dots$$ についても解を与える整数 $$a_2, a_3, \ldots$$ を求められる。
3. こうして得られる解の列は $$\mathbb{Z}_p \subset \mathbb{Q}_p$$ の元として一意の根を定める。

**証明のアイデア**:\
$$f'(a)$$ が $$\bmod\, p$$ で 0 にならないということは、$$x=a$$ の近傍で $$f(x)$$ が「良い振る舞い」をすることを意味する。$$a$$ を $$p^n$$ の倍数だけ微調整することで、$$f(a)$$ が $$\bmod\, p^n$$ で消えるようにできる。その調整を帰納的に繰り返せば、すべての $$p^n$$ で根を引き上げられる。

### 例 5.2

$$p=3$$ のとき、$$f(x) = x^2 - 1$$ を考える。

* **ステップ1（mod 3）**:\
  $$f(1) \equiv 0 \pmod{3}$$。また導関数は $$f'(x) = 2x$$ なので、$$f'(1)=2 \not\equiv 0 \pmod{3}$$。
*   **ヘンゼルの補題の適用**:\
    $$a=1$$ に対し、

    $$
    a_1 \equiv 1 \pmod{3},\quad
      f(a_1) \equiv 0 \pmod{9}
    $$

    を満たす一意の解 $$a_1$$ が存在する。実際に $$1^2 - 1 = 0$$ は 9 でも 0 なので、$$a_1 = 1$$ がそのままうまくいく。
* **さらなるリフティング（mod 9, mod 27, …）**:\
  同様に繰り返すと、$$a_1=1$$ を 3 の高い冪に対しても解に引き上げられる。最終的に、すべての 3 の冪と合同な解を含む $$\mathbb{Z}_3 \subset \mathbb{Q}_3$$ の中の根が得られる。

ヘンゼルの補題は、多くの古典的問題を大いに単純化する。つまり、$$\bmod\, p$$ での解が得られれば、それを $$\mathbb{Q}_p$$ 内の多項式の実際の根へと引き上げられるからである。

***

## 5.3. 収束、べき級数、そして $$p$$-進的解析函数

実解析では、$$\sum a_n (x-c)^n$$ のようなべき級数は $$\mathbb{R}$$ 上のある区間で収束を考える。しかし $$p$$-進の世界では、「距離」の概念が変わるので収束の振る舞いもまったく異なる。非アルキメデス的性質により、要素が「大きな冪で $$p$$ を因数に持つ」ほど急激に 0 に近づくため、多くの級数はむしろ $$p$$-進的には収束しやすい面を持つ。

### 5.3.1. 収束と収束半径

#### 定義 5.7 ($$\mathbb{Q}_p$$ における級数の収束)

$$\mathbb{Q}_p$$ における級数 $$\sum_{n=0}^\infty a_n$$ は、その部分和列が $$|\cdot|_p$$ に関してコーシー列をなすときに収束すると言う。同値だが、しばしば有効な必要条件は $$|a_n|_p \to 0$$ （$$n \to \infty$$）である。

#### 定理 5.8 (収束半径)

$$\mathbb{Q}_p$$ 上の係数をもつべき級数

$$
\displaystyle f(x) = \sum_{n=0}^\infty a_n (x-c)^n
$$

に対し、_収束半径_ $$R$$ は

$$
\frac{1}{R}
\;=\;
\limsup_{n\to\infty}\, \bigl|a_n\bigr|_p^{1/n}
$$

によって与えられる。すると、$$\bigl|\,x-c\,\bigr|_p < R$$ をみたすすべての $$x$$ に対して、$$f(x)$$ は $$p$$-進的に収束する。

**例 5.3**

* $$\mathbb{Q}_p$$ 上のべき級数 $$\sum_{n=0}^\infty p^n x^n$$ を考える。係数 $$p^n$$ は $$|p^n|_p = p^{-n}$$ なので、$$|p^n x^n|_p = p^{-n}|x|_p^n$$。もし $$|x|_p < 1$$ ならば、これは非常に速く 0 に近づくので級数は収束する。
* これを実数の場合（$$\sum_{n=0}^\infty p^n x^n$$）と比較すると、$$|x|$$ が $$1/p$$ より小さくないと級数は発散する。$$p$$-進世界とアルキメデス世界で収束条件が劇的に異なることがよくわかる。

### 5.3.2. マーラー展開と特殊値

#### マーラーの定理 (Mahler’s Theorem)

$$p$$-進解析において中心的な結果の 1 つがマーラーの定理である。これは、連続函数 $$f: \mathbb{Z}_p \to \mathbb{Q}_p$$ のすべてが、_マーラー級数_ と呼ばれる形で表せることを述べる：

$$
f(x) 
\;=\; 
\sum_{n=0}^\infty a_n \binom{x}{n},
\quad
\text{ただし }
\binom{x}{n} 
\;=\;
\frac{x(x-1)\cdots(x-n+1)}{n!}.
$$

ここで、$$\binom{x}{n}$$ は $$x \in \mathbb{Z}_p$$ に対しても定義でき、$$p$$-進付値と相性の良い組合せ的性質をもつ。

**意義**:

* マーラー展開は、実解析でのテイラー展開に類似するが、通常の冪ではなく二項係数 $$\binom{x}{n}$$ を使うという特徴がある。
* ベルヌーイ数や $$p$$-進 $$L$$-関数などの特別値を扱う際に、特に便利な形となる。

***

## 5.4. 局所大域原理とアディック拡大

### 5.4.1. 局所大域原理

現代数論における繰り返し登場するテーマとして、「$$\mathbb{Q}$$ 上の大域的な問題を解くには、まずすべての局所体、すなわち $$\mathbb{R}$$ および各 $$\mathbb{Q}_p$$ 上での両立性を調べる」という方針がある。

* **ハッセ–ミンコフスキーの定理 (Hasse–Minkowski theorem)**:\
  その代表例として、2 次形式 $$Q(x_1, \dots, x_n)$$ が $$\mathbb{Q}$$ 全体で自明なゼロ（非自明解）をもつかどうかは、$$\mathbb{R}$$ やすべての $$\mathbb{Q}_p$$ 上で非自明解をもつかどうかによって完全に決定される。
* **妨害 (Obstruction)**:\
  次数が高い形式になると、各 $$\mathbb{Q}_p$$ や $$\mathbb{R}$$ で局所的には解があっても、$$\mathbb{Q}$$ 上ではグローバルな解が存在しない場合がある。こうした微妙な差異はブラウアー–マニンの妨害（Brauer–Manin obstruction）などの高度な理論によって研究される。

### 5.4.2. 拡大体と分岐

$$\mathbb{Q}_p$$ のさらに上の拡大体（代数拡大）を考えることもできる。これは $$\mathbb{Q}$$ 上の代数拡大を調べるのと対応しており、その素数 $$p$$ が拡大体でどのように分解するかによって、_非分岐 (unramified)_、_整枝 (tamely ramified)_、_激しく分岐 (wildly ramified)_ などの現象が生じる。局所拡大（およびそれに付随する局所ガロワ表現）を理解することは、グローバルなガロワ群や保型形式を理解するうえでも極めて重要である。

#### アディック空間

さらに高度な取り扱いでは、$$\mathbb{Q}_p$$ を全ての完備化（実数体も含む）を同時に扱うアデールや、_アディック空間 (adic spaces)_ へと拡張する見方がある。こうした枠組みは、局所的データと大域的データを 1 つの幾何学的対象へ統合する役割を果たし、ディオファントス方程式の解が存在するかどうかに深い洞察をもたらす。

***

## 第5節のまとめ

$$p$$-進の視点は、数・距離・収束を捉える方法を一変させるものである。

* **可除性を「距離」として捉える**: 2 つの数の差がどれだけ大きな冪で $$p$$ を含むかによって、その 2 つが「どれほど近いか」を測る。
* **ヘンゼルの補題**: 多項式の合同解 ($$\bmod\, p$$) をすべての冪 $$\bmod\, p^n$$ へと引き上げ、最終的には $$\mathbb{Q}_p$$ の根を得る。
* $$p$$**-進解析**: べき級数や連続函数、マーラー級数展開といった概念は、非アルキメデス的世界でもしっかりと構築され、多くの場合むしろ扱いやすい性質を示す。
* **局所大域原理**: $$\mathbb{R}$$ と各 $$\mathbb{Q}_p$$ における解の存在を総合的に見ることで、$$\mathbb{Q}$$ におけるディオファントス方程式の解の有無を判定する枠組みが整う。

ヘンゼルによる黎明期の発想から、ガロワ表現や保型形式にまで至る今日的応用に至るまで、$$p$$-進手法は数論を語るうえで欠かせない武器となっている。フェルマーの最終定理の証明においても、各素数ごとの局所情報（$$p$$-進情報）が全体の構造を決定づける重要な要素となったことは、その好例と言えるでしょう。
