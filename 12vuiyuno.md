# 第12節:谷山–志村–ヴェイユ定理（半安定の場合）

**谷山–志村–ヴェイユ予想**（現在は完全に証明され、**モジュラー定理**と呼ばれる）は、一見すると大きく異なる 2 つの分野が深く結びついていることを示すものでした。

1. $$\mathbb{Q}$$ **上の楕円曲線（Elliptic Curves）**\
   これは、2 変数の 3 次方程式で定義される、種数 1 の滑らかな射影曲線です。さらに、加法群の単位元となる点（無限遠点）をひとつ指定しておくことで、曲線上に可換群構造が定まります。
2. **モジュラー形式（Modular Forms）**\
   これは、上半平面 $$\mathfrak{h}$$ 上で定義され、$$\mathrm{SL}_2(\mathbb{Z})$$ のある部分群に対して厳密な変換則を満たす複素解析的（あるいは代数的）関数です。

もともと算術幾何（楕円曲線側）と複素解析（モジュラー形式側）という別々の分野で研究されていた両者ですが、「$$\mathbb{Q}$$ 上のすべての楕円曲線は重み 2 のあるモジュラー形式と対応づけられる」という驚くべき予想（1950 年代の谷山豊の予想を、志村五郎とアンドレ・ヴェイユが精緻化）によって、この 2 つの対象が深いレベルで同一視できるのではないかと考えられるようになりました。1990 年代、アンドリュー・ワイルズの画期的な研究によって、この対応が**半安定**楕円曲線について証明されました。その後、Breuil・Conrad・Diamond・Taylor らの仕事によって、すべての $$\mathbb{Q}$$ 上の楕円曲線に対して定理が拡張され、完全な形での「谷山–志村–ヴェイユ定理」が確立されました。

この節では、以下の内容を扱います。

* **半安定**な場合における谷山–志村–ヴェイユ定理（楕円曲線の特定の還約性質に関するモジュラー性）
* 「モジュラー性」の定義と、そこにおける「強い」版・「弱い」版の区別
* 両者の $$L$$-関数を同一視することで得られる算術的帰結、特にバーチ–スウィンナートン＝ダイアー予想との関係

***

## 12.1 半安定楕円曲線とモジュラー形式

### 12.1.1 半安定性とモジュラー形式：主要な定義

#### $$\mathbb{Q}$$ 上の楕円曲線

$$\mathbb{Q}$$ 上の**楕円曲線** $$E$$ は、

$$
E: \quad y^2 = x^3 + a\,x + b
$$

の形（右辺の 3 次多項式に重根がないことによって非特異性を満たす）で与えられ、$$a, b \in \mathbb{Q}$$ です。さらに、しばしば「無限遠点」と呼ばれる点を 1 つ指定しておくことで、曲線に加法群構造が入ります。

* **整数モデル（Integral Model）**\
  分数係数を含む場合、それらの分母を払って整数係数の方程式に書き直すことがよく行われます。これによって素数 $$p$$ での「還約」（mod $$p$$ で曲線を考える）が可能となります。還約の様子から多くの算術的情報を読み取れます。
* **還約の型（Reduction Types）**\
  楕円曲線を素数 $$p$$ で還約したときに現れる曲線が
  * **良性還約（Good Reduction）**: 還約後も有限体 $$\mathbb{F}_p$$ 上で依然として楕円曲線をなす（非特異）。
  * **悪性還約（Bad Reduction）**: 還約後に特異点を持つ（結節点型や尖点型の特異点）。
    * 結節点型（乗法的・multiplicative）または尖点型（加法的・additive）

ある楕円曲線 $$E$$ が\*\*半安定（semistable）\*\*とは、すべての素数 $$p$$ において「良性還約」か「乗法的還約」しか起きないことを言います。すなわち「加法的還約」が一切存在しないということです。

> **定義（半安定楕円曲線）**\
> $$\mathbb{Q}$$ 上の楕円曲線 $$E$$ が半安定であるとは、任意の素数 $$p$$ で還約したとき、その還約が良性あるいは乗法的還約（結節点がある特異）となる場合をいう。

歴史的には、ワイルズが最初に証明した谷山–志村–ヴェイユ定理はこの「半安定」な場合でした。その後、半安定性の仮定は除かれ、より一般の場合へ拡張されました。

***

#### モジュラー形式

上半平面 $$\mathfrak{h} = \{\, z \in \mathbb{C} \mid \operatorname{Im}(z) > 0 \}$$ を考えます。**重み** $$k$$ **のモジュラー形式**（レベル $$N$$ に対して）とは、部分群 $$\Gamma_0(N)\subset \mathrm{SL}_2(\mathbb{Z})$$ に対して以下を満たす正則関数

$$
f\colon \mathfrak{h} \;\to\; \mathbb{C}
$$

のことをいいます。

1.  **変換則**\
    $$\Gamma_0(N)$$ に属する行列 $$\displaystyle \gamma = \begin{pmatrix} a & b \\ c & d \end{pmatrix}$$（ただし $$\det(\gamma)=1$$ かつ $$c\equiv 0 \pmod{N}$$）に対し

    $$
    f\!\Bigl(\tfrac{a z + b}{c z + d}\Bigr)
      \;=\;
      (c z + d)^{-k}\, f(z)
    $$

    を満たす。
2. **尖点（cusps）における正則性**\
   上半平面を作用でコンパクト化したときの「境界点」（有理数直線や $$\infty$$ を含む）において、正則（あるいは有限位数の極しか持たない）である。

さらに、**尖点ですべて 0 になる**モジュラー形式を\*\*尖形式（cusp form）**と呼びます。重み 2 の尖形式の中でも、レベル** $$N$$ **に対する**ニュー形式（newform）\*\*と呼ばれる原始的な尖形式が特に重要な役割を果たします。

> **重要な事実**: 重み 2 の場合、多くの幾何的・算術的性質（Galois 表現や $$L$$-級数など）が楕円曲線と直接対応します。そのため、谷山–志村–ヴェイユ定理では重み 2 に注目します。

***

### 12.1.2 半安定な谷山–志村–ヴェイユ定理の主張

アンドリュー・ワイルズが成し遂げた大成果は、概略的に次のように述べられます。

> **定理（半安定な谷山–志村–ヴェイユ）**\
> 半安定な $$\mathbb{Q}$$ 上の楕円曲線 $$E$$ は**モジュラー**である。具体的には、ある整数 $$N$$ に対する重み 2 のニュー形式 $$f$$ が存在して、
>
> $$
> L(E, s) \;=\; L(f, s)
> $$
>
> が成り立つ。ここで
>
> * $$L(E, s)$$ は楕円曲線 $$E$$ の Hasse–Weil $$L$$-級数、
> * $$L(f, s)$$ はモジュラー形式 $$f$$ に付随する古典的 $$L$$-級数\
>   をそれぞれ表す。

この 2 つの $$L$$-関数を同一視することは、「素数ごと」に対応する局所データ（楕円曲線側の還約情報と、モジュラー形式側のフーリエ係数）を一致させることと同義です。そして、$$L(f, s)$$ から引き継がれる**解析的続延**や**汎関数方程式**（functional equation）などの性質が $$L(E, s)$$ にも及ぶことになります。

当初は半安定曲線についてのみ証明されましたが、後にこの仮定は不要になり、現在では**あらゆる** $$\mathbb{Q}$$ 上の楕円曲線に対して**フル**なモジュラー定理が確立されています。

***

### 12.1.3 「強いモジュラー性」と「弱いモジュラー性」

「$$E$$ がモジュラーである」というときには、歴史的に見ると大きく 2 種類の内容があります。

1. **弱いモジュラー性（Weak Modularity）**\
   楕円曲線 $$E$$ の Hasse–Weil $$L$$-級数 $$L(E, s)$$ が「ある」重み 2 のモジュラー形式（必ずしもニュー形式ではない）$$f$$ の $$L$$-級数と一致する、という主張です。これは\*\*多くの有名な結果（たとえばフェルマーの最終定理）\*\*を導くには十分です。
2. **強いモジュラー性（Strong Modularity）**\
   強い版では、$$E$$ はレベル $$N$$ のニュー形式 $$f$$ と**厳密に**対応し、しかもそのレベル $$N$$ は $$E$$ の還約性質を反映する「導手（conductor）」と一致します。この「強いモジュラー性」は
   * 楕円曲線 $$E$$ に付随する Galois 表現の精密な取り扱い
   * トーション点や Selmer 群に関する情報
   * リベットの定理などで用いられるレベル降下（level lowering）\
     といった深い算術的応用にとって決定的に重要です。

実際的には、強い版が谷山–志村–ヴェイユの**完全な**主張を与えますが、弱い版でも多くの古典的な問題を解決するには十分でした。

***

## 12.2 $$L$$-級数の同値性とそこからの帰結

谷山–志村–ヴェイユ定理の中心テーマは、**楕円曲線側の Hasse–Weil** $$L$$**-級数**と（本来は複素解析的な性質をもつ）**重み 2 のモジュラー形式** $$f$$ **の** $$L$$**-級数**とを一致させることです。すなわち、

$$
L(E, s) \;=\; L(f, s)
$$

という関係を打ち立てます。これにより、$$L(f, s)$$ のもつ**解析的続延**や**汎関数方程式**などの厳密な解析的性質が、そのまま $$L(E, s)$$ にも遺伝します。以下では、このことがどのように展開するのかを概観します。

***

### 12.2.1 $$L$$-級数：オイラー積、解析的続延、汎関数方程式

#### (a) オイラー積（Euler Product）

1.  **楕円曲線側**\
    楕円曲線 $$E$$ に対して定義される Hasse–Weil $$L$$-級数は、素数全体にわたる（形式的な）積として

    $$
    L(E, s)
      \;=\;
      \prod_{p \,\text{prime}}
      \bigl(1 - a_p\, p^{-s} + p^{1-2s}\bigr)^{-1}
    $$

    と書けます。ここで

    $$
    a_p \;=\; p + 1 - \#E(\mathbb{F}_p)
    $$

    は素数 $$p$$ での点数が「期待値」$$p + 1$$ からどれくらいずれているかを測る量です（$$E$$ が良性還約の場合。乗法的還約のときは局所因子が少し異なりますが類似の形をとります）。
2.  **モジュラー形式側**\
    一方、重み 2 のニュー形式 $$f$$ を正規化して、フーリエ級数

    $$
    f(z)
      \;=\;
      \sum_{n=1}^\infty a_n \, q^n
      \quad (\;q = e^{2\pi i z}\;)
    $$

    と書くとき、この $$f$$ に対応する $$L$$-級数は

    $$
    L(f, s)
      \;=\;
      \sum_{n=1}^\infty \frac{a_n}{n^s}
      \;=\;
      \prod_{p}\Bigl(1 - a_p\, p^{-s} + \epsilon(p)\, p^{1-2s}\Bigr)^{-1}
    $$

    と表せます。ここで $$\epsilon(p)$$ はレベル $$N$$ と素数 $$p$$ の関係（$$p\mid N$$ かどうか）によって $$\pm 1$$ や $$1$$ を取ります。

$$L(E, s) = L(f, s)$$ という等式は、「素数 $$p$$ ごとの因子」が一致することに他なりません。これは実質的に「$$E$$ と $$f$$ から構成される Galois 表現が同型になる」ことを反映しています。

***

#### (b) 解析的続延

* **初期の収束領域**
  * $$L(E, s)$$ はオイラー積の形から $$\mathrm{Re}(s) > 3/2$$ 程度で絶対収束すると考えられる。
  * $$L(f, s)$$ はモジュラー形式論から**全平面正則**（尖形式の場合は極を持たない）であることが古くから知られている。
* **結論**\
  $$L(E, s) = L(f, s)$$ であるなら、モジュラー形式側で既に確立されている**整関数的な解析的続延**が $$L(E, s)$$ にも「移植」されることになります。楕円曲線の定義から直ちに $$L(E, s)$$ の全平面への解析的続延が得られるわけではなかったので、モジュラー性の確立はこの意味で非常に大きな進展でした。

***

#### (c) 汎関数方程式

レベル $$N$$ の重み 2 ニュー形式 $$f$$ に対して、次のように「完成された」$$L$$-関数

$$
\Lambda(f, s)
  \;=\;
  \Gamma\!\bigl(s + \tfrac{k-1}{2}\bigr)\,
  \Bigl(\frac{\sqrt{N}}{2\pi}\Bigr)^{s + \frac{k-1}{2}}\,
  L(f, s),
  \quad (k=2)
$$

を定義すると、

$$
\Lambda(f, s) \;=\; \pm\, \Lambda\!\bigl(f, k-s\bigr)
$$

という対称性（汎関数方程式）が成り立ちます。従って、$$L(E, s) = L(f, s)$$ であれば、$$L(E, s)$$ も同じ対称性を共有し、

$$
\Lambda(E, s) \;=\; \pm\, \Lambda(E, 2-s).
$$

という「反射公式」が成り立ちます。このような性質は**特殊値**（たとえば $$s=1$$ や他の整数点近傍）の解析に多大な影響を及ぼします。

***

### 12.2.2 算術的帰結：BSD など

$$L(E, s)$$ と $$L(f, s)$$ が一致するという事実がもたらす大きなメリットは、モジュラー形式に由来するさまざまな**古典的定理**を楕円曲線の深い算術的性質へ転用できる点です。代表的な例を 2 つ挙げます。

1. **バーチ–スウィンナートン＝ダイアー（BSD）予想**\
   **BSD 予想**は、$$s=1$$ での $$L(E, s)$$ の零点位数（オーダー）が、楕円曲線の有理点群 $$E(\mathbb{Q})$$ の階数（rank）と一致すると主張し、さらにテイラー展開の首項係数が Selmer 群や Tate–Shafarevich 群の大きさを支配すると予想します。
   * _モジュラー性が役立つ理由_: もし $$L(E, s)= L(f, s)$$ が確立されていれば、モジュラー形式側で知られている汎関数方程式などを利用して $$s=1$$ の近傍を調べることができます。モジュラー形式の特別値に関する理論は充実しており、それを楕円曲線の $$L$$-級数に直接応用できるようになるのです。
2. **Galois 表現**\
   楕円曲線 $$E$$ もモジュラー形式 $$f$$ も、絶対ガロワ群 $$\mathrm{Gal}(\overline{\mathbb{Q}}/\mathbb{Q})$$ への 2 次元表現を自然に定義します（$$E$$ の場合はトーション点への作用、$$f$$ の場合はモジュラーシンボル等による）。谷山–志村–ヴェイユ定理は、これら 2 つの表現が同型になることを意味し、リベットの定理で使われる**レベル降下**（level lowering）の議論など、フェルマーの最終定理の証明に不可欠なツールを提供します。

***

### 12.2.3 具体例

いくつかの具体例を見ると、定理の意味がより明確になります。

1.  **導手が 11 の曲線の例**\
    たとえば

    $$
    E:\quad y^2 + y = x^3 - x^2 - 10x - 20
    $$

    という楕円曲線を考えると、これは導手（conductor）$$N=11$$ をもつことが知られています。一方、モジュラー形式側では、レベル 11 の重み 2 ニュー形式 $$f$$ が（定数倍を除いて）一意に存在し、そのフーリエ係数 $$\{a_p\}$$ が $$\#E(\mathbb{F}_p)$$ 由来の係数と素数 $$p$$ ごとに一致します。たとえば以下のように

    $$
    \begin{array}{c|cccccc}
        p & 2 & 3 & 5 & 7 & 11 & 13 \\
        \hline
        a_p & 1 & 0 & -1 & 0 & \ast & \dots
      \end{array}
    $$

    と並べることができ、実際にこれらを素数ごとに検証すると、$$L(E,s)$$ と $$L(f,s)$$ は Euler 積レベルでも一致します。
2. **フェルマーの最終定理との関係**\
   フェルマーの最終定理（$$x^n + y^n = z^n$$ に非自明解が存在しない）そのものは「楕円曲線の定理」ではありませんが、この問題に対するワイルズの証明は、もし非自明解が存在したならば、そこから構成できる楕円曲線が「モジュラー」でなければならないことを示し、さらにガロワ表現の局所特性を矛盾へと導く、という手法でした。つまり楕円曲線のモジュラー性がなければ、フェルマーの最終定理の証明は成り立ちませんでした。

これらの例は、どの素数 $$p$$ に対しても**局所的データ**が一致することが谷山–志村–ヴェイユ定理の核心であることを示しています。そして一度一致が成り立てば、モジュラー形式に固有の解析的手法が楕円曲線の算術研究にも活用できるようになるのです。

***

## 12.3 まとめの直観

* **幾何学 vs. 解析学の視点**\
  楕円曲線は、複素数体上では「格子 $$\Lambda$$ をとって $$\mathbb{C}/\Lambda$$ とみなすトーラス」として理解できるのに対し、モジュラー形式は $$\Gamma_0(N)$$ の変換則を満たす正則関数です。谷山–志村–ヴェイユ定理は、これら 2 つの視点が一つの物語に統合されることを示すものです。
* **なぜ重要か**\
  $$L(E, s)$$ と $$L(f, s)$$ が一致することで、これまでモジュラー形式の世界でしか保証されていなかった**解析的性質**（解析的続延や汎関数方程式）を楕円曲線にも「貸し出す」ことが可能になります。実際、それによって**フェルマーの最終定理**という数世紀もの難問が決着し、**バーチ–スウィンナートン＝ダイアー予想**の部分的な進展ももたらされました。
* **より広い展望（Langlands プログラム）**\
  楕円曲線とモジュラー形式の対応は、**Langlands プログラム**と呼ばれる「ガロワ表現と保型形式の対応」を高次元へ一般化する壮大な構想の中の特別な例でもあります。楕円曲線の場合は、Langlands プログラムの「2 次元例」の成功例として、後の発展にきわめて大きな影響を与えています。

次の節以降では、楕円曲線とモジュラー形式に付随する**ガロワ表現**や、それらを扱うための**変形理論**を構築し、「なぜこれらの同一視が成り立つのか」「どのようにワイルズの方法（およびその改良）でフェルマーの最終定理が解決されたのか」を探っていきます。

***

## 参考文献とさらなる読み物

* **Silverman, J. H.** _The Arithmetic of Elliptic Curves_. Springer, 1986.\
  （楕円曲線の算術理論、還約の型、局所不変量などの詳しい導入。）
* **Shimura, G.** _Introduction to the Arithmetic Theory of Automorphic Functions_. Princeton University Press, 1971.\
  （モジュラー形式やモジュラー曲線の基礎と代数幾何学的側面を扱う古典的教科書。）
* **Diamond, F. & Im, J.** _Modular Forms and Modular Curves_. 『Seminar on Fermat’s Last Theorem』(Canadian Mathematical Society, 1995) pp. 39–133.\
  （ニュー形式やガロワ表現がどのように楕円曲線と対応するか、包括的に解説。）
* **Wiles, A.** “Modular elliptic curves and Fermat’s Last Theorem.” _Annals of Mathematics_, 141(3):443–551, 1995.\
  （半安定な谷山–志村–ヴェイユ定理を証明した画期的論文。）

***

**第 12 節 おわり**

この節では、**谷山–志村–ヴェイユ定理**（半安定の場合）を導入し、楕円曲線とモジュラー形式の定義や、素数ごとの局所因子の一致に基づく $$L$$-級数の同一視を解説しました。次の節では、**ガロワ表現**や**変形理論**などの技術的背景に踏み込み、こうした同一視がどのように実現され、**フェルマーの最終定理**のような大定理がどのようにして証明されるのかを詳しく見ていきます。
