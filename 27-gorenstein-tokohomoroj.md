# 第27節: Gorenstein 性とコホモロジー次元

数論、特に **保型形式 (modular forms)** や **ガロア表現 (Galois representations)**、そこから構成される **Hecke代数 (Hecke algebras)** の研究において、扱われるある種の環が _Gorenstein_ となることは非常に重要です。ざっくり言えば、これはその環がある種の「自己双対性 (self-duality)」を持ち、環論的・ホモロジー的性質を厳密に制御できることを意味します。

この節では以下を解説します:

1. **Gorenstein 性とは何か**、および **それが「完全ペアリング (perfect pairing)」構造を与える理由**。
2. **余接空間 (cotangent space) との関連**、そしてそこから _Selmer 群_ やコホモロジー次元への結びつき。
3. **「大域次元 (global dimension)」に基づく議論** が、Gorenstein 環を用いてどのように加群の有限射影次元（あるいは有限入射次元）を示すのに使われるか。

最後に、歴史的背景（例えばワイルズによるフェルマーの最終定理の証明）で Gorenstein 性がいかに重要だったかを概観し、より単純な代数的状況における **具体例** を通して Gorenstein 環のイメージを示します。

***

## **27.1 変形環とHecke代数を対応づける意義**

### **27.1.1 定義と基本的性質**

**Definition (Gorenstein Ring).**\
可換環 $$(R,\mathfrak{m})$$ が Noether 環かつ局所環であるとき、$$R$$ が **Gorenstein** であるとは、$$R$$-加群としての _入射次元 (injective dimension)_ が有限であることをいう。具体的には、ある $$R$$-加群として入射的な加群の有限射影（あるいは自由）分解が存在することを意味する。別の言い方をすると、$$R$$ が Cohen–Macaulay である場合、Gorenstein であることは _正準加群_（しばしば $$\omega_R$$ と書く）が $$R$$ と同型であることに同値である。

この定義から特に重要な事実が 2 つ得られます:

1.  **自己双対性 (self-duality)**: Gorenstein 環はホモロジー代数的に自己双対性を示す。しばしば次のような同型として現れる：

    $$
    \mathrm{Hom}_R\bigl(\mathrm{Ext}^i_R(M,R), R\bigr) \;\cong\; \mathrm{Ext}^{d-i}_R(M,R),
    $$

    ここで $$d = \dim(R)$$。
2. **有限射影次元・入射次元**: 環自身が有限入射次元を持つため、Gorenstein 環上の加群はしばしば良好なホモロジー的性質（$$\mathrm{Ext}$$ や $$\mathrm{Tor}$$ の評価に関する有界性など）を享受する。

***

### **27.1.2 Gorenstein が「完全ペアリング」を与える理由**

Gorenstein な局所環を仮定すると、コホモロジー群に自然な _完全ペアリング_ が存在することが大きな利点として挙げられます。以下の状況を考えましょう:

*   $$R$$ が Gorenstein であるとき、$$\mathrm{Ext}^i_R(M,R)$$ のような自然に定義される群が _反射的 (reflexive)_ となり、次のような非退化ペアリングが得られます:

    $$
    \mathrm{Ext}^i_R(M,R) \;\times\; \mathrm{Ext}^{d-i}_R(M,R)
    \;\longrightarrow\;
    \mathrm{Ext}^d_R(M,R)
    \;\cong\; k,
    $$

    ここで $$k = R/\mathfrak{m}$$（$$R$$ が次元 $$d$$ の局所環の場合）。
* この性質は、$$R$$ が **Hecke代数**（ある極大イデアルで局所化したもの）や、剰余ガロア表現の変形を表す **変形環 (deformation ring)** の役割を果たすときに、数論幾何で特に重要になります。

**Theorem (Gorenstein 局所環における完全ペアリング).**\
次元 $$d$$ の Gorenstein 局所環 $$(R,\mathfrak{m})$$ と有限生成 $$R$$-加群 $$M$$ に対し、

$$
\mathrm{Hom}_R\bigl(\mathrm{Ext}^i_R(M,R), R\bigr)
\;\cong\;
\mathrm{Ext}^{d-i}_R(M,R)
$$

という自然同型が存在する。さらに（例: $$\mathrm{Ext}^d_R(M,R)\cong k$$ など適当な仮定のもと）この同型から

$$
\mathrm{Ext}^i_R(M,R) \;\times\; \mathrm{Ext}^{d-i}_R(M,R)
\;\longrightarrow\; k
$$

という非退化な双線型形式が得られる。

**Sketch of Proof.**\
主なステップは、$$R$$ が Gorenstein であることにより、ホモロジー代数において $$R$$ が _自己双対_ な分解を持つ点にある。そのため $$\mathrm{Ext}^i$$ と $$\mathrm{Ext}^{d-i}$$ の間に双対性が生じる。

***

### **27.1.3 変形環とHecke代数を対応づける理由**

数論においては、次のような状況が典型例です:

* 極大イデアル $$\mathfrak{m}$$ で局所化した **Hecke代数** $$\mathbb{T}_\mathfrak{m}$$ が Gorenstein であることがしばしば示される。
* ガロア表現 $$\bar{\rho}$$ の変形をパラメータ化する **変形環** $$R_\mathrm{def}$$（いくつかの局所条件を課すことで定義される）が、同様に Gorenstein や完全交叉 (complete intersection) となる場合がある。

ワイルズの「$$R = \mathbb{T}$$」法において肝要となるのは:

1. **変形環** $$R_\mathrm{def}$$ から **Hecke代数** $$\mathbb{T}_\mathfrak{m}$$ への全射 $$R_\mathrm{def} \twoheadrightarrow \mathbb{T}_\mathfrak{m}$$ を与えること。
2. **次元の一致**（環の次元や完全ペアリングによるホモロジー的次元比較）を駆使して、その写像が単射でもあると示し、結果として同型を得ること。

**Example (局所的類推).**

$$
R = \mathbb{Z}_p[[X]] / (f)
$$

の形を考える。ここで $$f$$ は形式的冪級数環である $$\mathbb{Z}_p[[X]]$$ の _既約元_ と仮定し、かつ零因子でない（正則列 (regular sequence) が長さ 1 で与えられる）などの条件を満たすとき、$$R$$ は Gorenstein 環となる。このとき、$$\mathbb{Z}_p[[X]]$$ 自体が正則局所環 (regular local ring) であり、(f) による剰余環 $$R$$ も自己双対性を示す構造が綺麗に現れる。

***

## **27.2 余接空間と Selmer 群**

### **27.2.1 正接空間・余接空間**

ある対象、例えばガロア表現 $$ \rho: \mathcal{G} \to \mathrm{GL}_2(k)$$ を変形するとき、最大イデアルで局所化した変形環の **正接空間 (tangent space)** が、その対象の一階変形の情報を担います。

**Definition (Tangent and Cotangent Spaces).**\
局所環 $$(R,\mathfrak{m})$$ に対して:

* **正接空間** は $$\mathfrak{m}/\mathfrak{m}^2$$ と定義される。
* **余接空間** はその双対ベクトル空間 $$\mathrm{Hom}_R(\mathfrak{m}/\mathfrak{m}^2, R/\mathfrak{m})$$ である。

普遍変形環 $$R_\mathrm{def}$$ の場合、その最大イデアル $$\mathfrak{m}$$ に対する $$\mathfrak{m}/\mathfrak{m}^2$$ の次元（剰余体上での次元）が典型的には $$\mathrm{ad}\,\rho$$ に対するガロアコホモロジー $$H^1(\mathcal{G}, \mathrm{ad}\,\rho)$$ の次元を表し、余接空間は $$\mathrm{Ext}^1_{R_\mathrm{def}}(k,k)$$ や $$H^2(\mathcal{G}, \mathrm{ad}\,\rho)$$ と関連づけられることが多いです。

***

### **27.2.2 Selmer 群とガロアコホモロジー**

**Selmer 群** は大雑把に言えば、$$H^1(\mathcal{G}, \mathrm{ad}\,\rho)$$ の部分空間で、素点ごとの（例: ある素数での非分岐、$$p$$ での crystalline 条件など）「局所条件 (local conditions)」を満たす共通部分として定義されます。

1. **大域ガロア群** $$\mathcal{G}$$: 一般には $$\mathcal{G} = \mathrm{Gal}(\overline{\mathbb{Q}}/\mathbb{Q})$$ やその部分群を考える。
2. **局所条件**: 各素点 $$v$$ でガロア群 $$\mathcal{G}_v$$（その素点に対応する分解群）を使った $$H^1(\mathcal{G}_v, \mathrm{ad}\,\rho)$$ の部分空間を指定する。これらを全ての $$v$$ で組み合わせることで、$$H^1(\mathcal{G},\mathrm{ad}\,\rho)$$ の部分群を定義する。

**Remark.** Selmer 群の双対はしばしば $$H^2(\mathcal{G}, \mathrm{ad}\,\rho)$$ の商と同一視される。この双対性はガロアコホモロジーの局所–大域原理の一形態であり、変形理論における次元チェックに不可欠です。

***

### **27.2.3 次元の計算と Gorenstein 的双対性**

Gorenstein 環があると、次のような「きれいな」対応が保証されます:

* **変形環** の正接空間（すなわち $$\dim H^1$$ のような次元情報）と、**Hecke代数** 側の類似の次元がうまく対応する。
* **障害空間 (obstruction space)**（しばしば $$H^2$$ に関連する）の次元も同様に一致する。

もし Gorenstein 性がなければ、ホモロジー構造に微妙な「ずれ」が生じる可能性があり、$$R_\mathrm{def} \cong \mathbb{T}$$ の証明に必要な次元対応が崩れてしまう恐れがあります。

***

## **27.3 大域次元を用いた議論**

### **27.3.1 大域次元と導来関手**

ホモロジー代数において、_大域次元 (global dimension)_ は「その環上の _すべての加群_ の射影次元の上限」として定義されます。Gorenstein な局所環では、

* 環自身が加群として有限入射次元を持ち、しばしば他の加群にも有限射影次元をもたらす。
* $$\mathrm{Ext}^i_R$$ や $$\mathrm{Tor}_i^R$$ といった導来関手が、ある次数以上で消滅したり強い双対性をもったりする場合が多い。

**Theorem (Gorenstein 環の有限入射次元).**\
$$(R,\mathfrak{m})$$ が Gorenstein 局所環ならば、$$R$$ は自身を加群とみなしたときに有限入射次元を持つ。その結果、ある程度以上の次数の $$\mathrm{Ext}$$ や $$\mathrm{Tor}$$ が消滅するなどの性質が生じる。

***

### **27.3.2 Hecke代数への応用**

局所化したHecke代数 $$\mathbb{T}_\mathfrak{m}$$ が Gorenstein であることを証明する標準的なアプローチとしては:

1. **コホモロジーによる同定**: $$\mathbb{T}_\mathfrak{m}$$ を、あるモジュラー形式空間やモジュラー曲線のコホモロジー群の自己準同型環として特徴づける。
2. **局所–大域整合性**: 極大イデアルで局所化する各段階で、対応する局所ガロア表現を制御する条件と整合するようにチェックする。
3. **有限射影次元の証明**: $$\mathbb{T}_\mathfrak{m}$$ が適当な加群に単射または全射で埋め込まれ、その結果 $$\mathrm{Tor}_i$$ や $$\mathrm{Ext}^i$$ がある有限段階以上では消滅することを示す。

こうして $$\mathbb{T}_\mathfrak{m}$$ が Gorenstein であると分かると、変形環 $$R_\mathrm{def}\$$ との次元比較が可能になり、ワイルズ他が用いた「パッチング」法による大きな定理の証明につながります。

***

## **歴史的背景と例**

### **27.4.1 Mazur の先駆的研究**

バリー・メイザー (Barry Mazur) は、ガロア表現 $$ \rho $$ に対して局所条件を課すことで $$H^1(\mathcal{G},\mathrm{ad}\,\rho)$$ の形状を制限するという「変形理論的」視点を最初期に発展させました。彼の枠組みは、_普遍変形環 (universal deformation ring)_ を厳密に定義し、これを代数幾何学的対象（形式的冪級数環の商）として扱う流れを確立し、そこにしばしば Gorenstein 性が現れることを示す基礎を築きました。

***

### **27.4.2 Ribet のレベル降下定理**

ケン・リベット (Kenneth Ribet) が証明した「レベル降下 (level-lowering) 定理」（フェルマーの最終定理の証明に不可欠）は、Gorenstein 性の議論そのものとはやや文脈が異なるものの、モジュラー形式とその $$p$$-進的性質を用いたコホモロジー的手法であり、Gorenstein 的な考え方と近いものが含意されています。

***

### **27.4.3 ワイルズのパッチング法**

アンドリュー・ワイルズ (Andrew Wiles) がフェルマーの最終定理を証明する際に不可欠だったのが、**普遍変形環** と **（局所化された）Hecke代数** の 2 つの環を対応させ、それらが実は同一であることを示すことでした。このとき Gorenstein 性は次のステップで大きな役割を果たします:

1. **全射**: $$R_\mathrm{def}$$ から $$\mathbb{T}_\mathfrak{m}$$ への自然な写像 $$R_\mathrm{def} \twoheadrightarrow \mathbb{T}_\mathfrak{m}$$ の構成。
2. **次元比較**: $$H^1(\mathcal{G}, \mathrm{ad}\,\rho)$$ や $$H^2(\mathcal{G}, \mathrm{ad}\,\rho)$$ の次元対応を用いて両環の「大きさ」が同じであると示す。
3. **完全ペアリング**: Gorenstein 性による双対性により、上記の写像が同型となる（$$R = \mathbb{T}$$）ことを結論づける。

***

### **27.4.4 具体的な完全交叉の例**

**Example (一次元 Gorenstein 完全交叉).**\
形式的冪級数環 $$\mathbb{Z}_p[[X]]$$ を取り、そこに _既約_ な $$f(X)$$ を取る（つまり $$(f)$$ が素イデアルとなる）とき、

$$
R \;=\; \mathbb{Z}_p[[X]]/(f)
$$

はしばしば _Cohen–Macaulay_ となり、さらに $$(f)$$ が零因子でない（長さ 1 の正則列）場合、$$R$$ は 1 次元の **完全交叉 (complete intersection)** となって Gorenstein 性を獲得する。

**Example (高次元での完全交叉).**\
より一般に、

$$
R \;=\; \mathbb{Z}_p[[X_1, \dots, X_n]] \;/\; (f_1, \dots, f_r)
$$

の形で、$$\{f_1,\dots,f_r\}$$ が長さ $$r$$ の正則列を成す場合、$$R$$ は完全交叉となり Gorenstein となる。ここで Cohen–Macaulay 性と、$$\langle f_1,\dots,f_r\rangle$$ の「余次元 (codimension)」が $$r$$ と一致することが鍵になる。

このような環は、しばしば _普遍変形環_ がもつ形（複数変数の形式的冪級数環に関係式を施した商）に類似している。実際、多くの普遍変形環は「自由変形方向」を担う何変数かの形式的冪級数環に、局所条件・大域条件からくる関係式を課したものとして得られ、完全交叉および Gorenstein 性が典型的に生じる。

***

## **結論**

**Gorenstein 性** は現代の算術幾何学において極めて重要な位置を占めています。主な理由は:

1. **有限な射影次元・入射次元** を保証すること、
2. コホモロジー群に対して **完全ペアリング (perfect pairing)** を与える（双対定理が成り立つ）こと、
3. 局所変形データと大域保型データを結びつける際に、**ホモロジー的制約** が良好に働くこと。

メイザーによる基礎づけからワイルズの歴史的証明に至るまで、ガロア表現とHecke代数の対応を理解する上で Gorenstein 環の双対性は不可欠でした。これは $$\mathfrak{m}/\mathfrak{m}^2$$ の次元（= $$H^1$$ の次元）、$$\mathrm{Ext}$$ 群の対応、Selmer 群の大きさなどに完璧な対応をもたらします。より単純な代数状況（形式的冪級数環の完全交叉）を例に見れば分かるとおり、Gorenstein 性の本質は「自己双対性」にあり、それが数論の深い場面で決定的な役割を果たします。

最終的に、これらの事柄は **可換代数** と **算術幾何学** の深い結びつきを示す好例と言えます。

***

_第27節 終わり_
