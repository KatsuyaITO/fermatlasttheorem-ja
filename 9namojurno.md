# 第9節:古典的なモジュラー形式の理論

モジュラー形式は、複素解析・代数幾何・数論が交差する美しい分野に位置します。その起源はヤコビ（Jacobi）やアイゼンシュタイン（Eisenstein）の業績、さらにクライン（Klein）やポアンカレ（Poincaré）によって高められたもので、上半平面上の分数変換群（フラクショナル・リニア変換群）に対して不変性を持つ関数の重要性を示しました。本節では、こうしたモジュラー形式の古典的理論を展開します。まずは、$$\mathrm{SL}_2(\mathbb{Z})$$ の作用から出発して上半平面における基本領域を扱い、そこからモジュラー形式の定義と基本的性質を導入し、最終的には合同部分群に対する変換性を取り扱います。

本節は以下の3つの部分に分けられます。

1. **9.1 上半平面上の正則関数**
   * 動機と歴史的背景、そしてモジュラー群の作用。
   * 基本領域の考察。
   * $$\mathrm{SL}_2(\mathbb{Z})$$ 上のモジュラー形式と尖点形式（カスプ形式）の導入。
2. **9.2 フーリエ級数、ウエイト、レベル、およびネーベンタイプ指標**
   * $$q$$-展開とフーリエ級数の中心的役割。
   * $$\mathrm{SL}_2(\mathbb{Z})$$ から高いレベルの合同部分群への一般化。
   * キャラクタ（ネーベンタイプ）を伴うモジュラー形式。
   * オールド形式とニュー形式。
3. **9.3** $$\mathrm{SL}_2(\mathbb{Z})$$ **およびその合同部分群下での変換**
   * 合同部分群 $$\Gamma_0(N)$$, $$\Gamma_1(N)$$ の定義。
   * Atkin–Lehner 変換とモジュラー形式空間への作用。

本節を終える頃には、読者は古典的理論の主要な枠組みを身につけ、Hecke作用素やガロア表現、そして楕円曲線やフェルマーの最終定理への応用など、さらに深い話題へと進む準備ができていることでしょう。

***

## **9.1 上半平面上の正則関数**

### **9.1.1 動機と歴史的背景**

モジュラー形式の起源は、19世紀における三角関数や楕円積分の研究にまで遡ります。ヤコビやアイゼンシュタインは、特別な関数（後に **アイゼンシュタイン級数** と呼ばれる）がある種の対称性を持つことを発見しました。この対称性は特定の分数変換群に対する不変性を示唆しており、クラインやポアンカレの時代になると、**保型関数 (automorphic function)** という視点が確立しました。これは、離散的な分数変換群に対して不変（あるいは “ほぼ” 不変）となる関数を統一的に捉えたもので、深い数論的帰結をもたらすことが明らかになりました。

その中心的存在が、**モジュラー群** $$\mathrm{SL}_2(\mathbb{Z})$$（あるいはその射影バージョン $$\mathrm{PSL}_2(\mathbb{Z})$$）です。この群は複素上半平面

$$
\mathcal{H} \;=\; \{ z \in \mathbb{C} \mid \operatorname{Im}(z) > 0 \}
$$

上で、次の分数変換によって作用します:

$$
\gamma = \begin{pmatrix} a & b \\ c & d \end{pmatrix} \in \mathrm{SL}_2(\mathbb{Z})
\;\;\mapsto\;\; 
\gamma \cdot z \;=\; \frac{a z + b}{c z + d}.
$$

$$\gamma$$ が $$\mathrm{SL}_2(\mathbb{Z})$$ に属するためには $$ad - bc = 1$$ という行列式 1 の条件を満たすので、この変換は上半平面を保ちます。**（古典的）モジュラー形式** とは、この作用の下で特定の対称性（変換則）と成長条件を満たす正則関数のことです。興味深い事実として、これらの関数はフーリエ展開に深い数論的情報を含んでおり、谷山–志村予想や最終的には **フェルマーの最終定理** の証明でも決定的な役割を果たします。

### **9.1.2 モジュラー群の作用と基本領域**

#### **定義 9.1（モジュラー群の作用）**

$$\gamma = \begin{pmatrix} a & b \\ c & d \end{pmatrix} \in \mathrm{SL}_2(\mathbb{Z})$$ とし、任意の $$z \in \mathcal{H}$$ に対して

$$
\gamma \cdot z \;=\; \frac{a z + b}{c z + d}
$$

と定義する。この作用は、$$\gamma_1 \cdot (\gamma_2 \cdot z) = (\gamma_1\gamma_2)\cdot z$$ を満たす群作用である。

$$\mathrm{SL}_2(\mathbb{Z})$$ の不変（あるいは準不変）な関数を扱うにあたって重要な道具となるのが、**基本領域** という概念です。

#### **定理 9.2（**$$\mathrm{SL}_2(\mathbb{Z})$$ **の基本領域）**

$$\mathrm{SL}_2(\mathbb{Z})$$ が $$\mathcal{H}$$ に作用する際の、1つの適切な基本領域として

$$
\mathcal{F} \;=\; 
\Bigl\{\, z \in \mathcal{H} \,\Bigm|\, 
-\tfrac12 < \operatorname{Re}(z) \le \tfrac12, \; |z| \ge 1 \Bigr\}
$$

をとることができる。境界部分での同一視を除けば、上半平面の任意の点は $$\mathrm{SL}_2(\mathbb{Z})$$ の作用によって $$\mathcal{F}$$ のちょうど一つの点に移される。具体的には以下が成り立つ:

1. 垂直な境界線 $$\operatorname{Re}(z)=\pm\tfrac12$$ は、$$z \mapsto z+1$$ という変換によって同一視される。
2. 下側の境界にある円弧 $$|z|=1$$ は、$$z \mapsto -1/z$$ などの変換によって同一視される。

**（証明スケッチ）** 群作用が $$\mathcal{H}$$ 上で適切に離散的（properly discontinuous）に作用するため、平行移動 $$z \mapsto z+1$$ と反転 $$z \mapsto -1/z$$ を使って上半平面を「折りたたむ」ことができる。詳細は Serre の『A Course in Arithmetic』など古典的文献を参照。

**備考**

$$\mathcal{F}$$ に制限すると（境界同一視を除いて）有限領域が残るため、解析的な多くの問題（有界性や積分など）が有限領域に帰着され、議論が大きく簡単になる。

### **9.1.3 尖点形式と一般のモジュラー形式**

ここで、正則モジュラー形式の古典的定義に到達します。直観的には、上半平面上の正則関数 $$f$$ が、$$\mathrm{SL}_2(\mathbb{Z})$$ の下である種の機能方程式（functional equation）を満たし、「無限遠点」などにおいて適切な（有界な）振る舞いをする、という状況を考えます。

#### **定義 9.3（正則モジュラー形式）**

$$f: \mathcal{H} \to \mathbb{C}$$ を正則関数とする。これが重み $$k$$ の **（正則）モジュラー形式** であるとは、次の条件を満たすときにいう:

1.  **変換則**：任意の$$((a,b),(c,d) ) \in  \mathrm{SL}_2(\mathbb{Z})$$に対して&#x20;

    $$
    f\Bigl(\tfrac{a z + b}{c z + d}\Bigr) \;=\; (c z + d)^{-k}\, f(z)
    $$

    が成り立つ。
2. **無限遠点での成長条件**：$$\operatorname{Im}(z)\to\infty$$ で $$f(z)$$ が多項式的な上界を持つ（少なくとも本質的特異点を持たない）こと。\
   これは、$$z = i\infty$$ まわりの **フーリエ級数展開** で極や本質的特異点がないことと同値である。

**備考**\
無限遠点で極を許すとより広いクラスの **有理型（整準保型）モジュラー形式** が得られるが、ここでは極を持たない純正則の場合を扱う。

#### **定義 9.4（尖点形式）**

重み $$k$$ の **尖点形式（カスプ形式）** とは、上記の正則モジュラー形式であって、$$i\infty$$（や一般化として他の尖点）において **消失**（vanish）するものをいう。フーリエ展開

$$
f(z) \;=\; \sum_{n=0}^\infty a_n \, e^{2\pi i n z}
$$

をとるとき、定数項 $$a_0$$ が零になることが尖点形式の条件になる。つまり、$$\operatorname{Im}(z)\to\infty$$ で「消えて」いく形式を指す。

**例 9.5（アイゼンシュタイン級数と尖点形式）**

* **アイゼンシュタイン級数** $$E_k(z)$$ は（$$k>2$$ のとき）定数項が非零となるため、尖点形式 **ではない** 典型例である。
* 一方で、アイゼンシュタイン級数の特定の線型結合は、定数項を相殺して **尖点形式** になる場合もある。

19世紀の数学では、任意のモジュラー形式がアイゼンシュタイン級数の部分と尖点形式の部分へ分解できるという事実が、フーリエ係数の算術的性質を理解する上で画期的なステップとなった。

***

## **9.2 フーリエ級数、ウエイト、レベル、およびネーベンタイプ指標**

$$\mathrm{SL}_2(\mathbb{Z})$$ が基本的な例ですが、より繊細な数論的情報を得るには、**合同部分群** を扱うことが有益です。こうして得られるのがモジュラー形式の **レベル** $$N$$ や、ディリクレ指標を用いた追加のねじれ（**ネーベンタイプ**）です。これにより、ガロア表現や楕円曲線など、さらに広範な応用が期待できます。

### **9.2.1** $$q$$**-展開とフーリエ級数**

モジュラー形式の特徴的な性質として、$$i\infty$$ まわりの **フーリエ展開**（あるいは $$q$$-展開）があります。ここで $$q = e^{2\pi i z}$$ とおくと、$$\operatorname{Im}(z)>0$$ のとき $$|q|<1$$ が成り立ちます。重み $$k$$ のモジュラー形式 $$f(z)$$ は

$$
f(z) \;=\; \sum_{n=0}^\infty a_n \, q^n
\quad (\;q = e^{2\pi i z}\;)
$$

のように展開されます。

* フーリエ係数 $$a_n$$ は、多くの場合代数的整数環など、ある種の数域に属する。
* 尖点形式では $$a_0=0$$ となる。

#### **定理 9.6（フーリエ展開の収束性）**

$$f$$ を重み $$k$$ の正則モジュラー形式とすると、任意の $$\epsilon>0$$ に対して $$\operatorname{Im}(z)\ge \epsilon$$ となる領域では、このフーリエ級数は絶対かつ一様に収束する。したがって、$$f$$ は $$q$$ のべき級数として取り扱うことが可能であり、多くの解析的問題が $$q$$**-べき級数** に関する問題へと変換される。

### **9.2.2 ウエイトとレベル**

#### **定義 9.7（合同部分群とレベル）**

$$\mathrm{SL}_2(\mathbb{Z})$$ の部分群 $$\Gamma$$ がレベル $$N$$ の **合同部分群** であるとは、

$$
\Gamma(N) \;=\; \Bigl\{\;\gamma \in \mathrm{SL}_2(\mathbb{Z}) \;\Bigm|\;
\gamma \equiv \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix} \mod N\Bigr\}
$$

を含むような部分群 $$\Gamma$$ であることをいう。代表的な例として次の2つがある。

*   $$\Gamma_0(N)$$:

    $$
    \Gamma_0(N) = 
    \Bigl\{\;\gamma = \begin{pmatrix}a & b\\ c & d\end{pmatrix}\in \mathrm{SL}_2(\mathbb{Z})
    \;\Bigm|\;
    c \equiv 0 \pmod{N}\Bigr\}.
    $$
*   $$\Gamma_1(N)$$:

    $$
    \Gamma_1(N) = 
    \Bigl\{\;\gamma = \begin{pmatrix}a & b\\ c & d\end{pmatrix}\in \mathrm{SL}_2(\mathbb{Z})
    \;\Bigm|\;
    c \equiv 0 \pmod{N},\; a \equiv d \equiv 1 \pmod{N}\Bigr\}.
    $$

レベル $$N$$ の重み $$k$$ のモジュラー形式とは、$$f:\mathcal{H}\to \mathbb{C}$$ が正則で、

$$
f(\gamma \cdot z) \;=\; (c z + d)^{-k} \, f(z)
\quad
\text{(全ての }\gamma\in \Gamma_0(N)\text{ に対して)}
$$

を満たし、さらに各尖点での有界性（あるいは消失）条件を満たす関数をいう。

**例 9.8**

たとえば $$\Gamma_0(4)$$ では、$$\gamma$$ の左下成分 $$c$$ が 4 で割り切れるような変換に対して不変性（重みに応じた変換則）を持つ形式を考える。$$\mathrm{SL}_2(\mathbb{Z})$$ よりも多くの尖点（有限有理数点を含む）を持つため、各尖点での正則性（あるいは消失）をチェックする必要がある。その際には、$$q$$-展開に類似した局所展開を各尖点で考える。

### **9.2.3 ネーベンタイプ指標**

#### **定義 9.9（ディリクレ指標）**

$$N$$ を法とする **ディリクレ指標** とは、$$\mathbb{Z}$$ 上に定義された関数 $$\chi$$ であって、$$N$$ を法とした周期性・乗法性を満たし、かつ $$\gcd(n,N)\neq 1$$ である $$n$$ に対しては $$\chi(n)=0$$ となるものをいう。

変換則に $$\chi(d)$$ といった因子を許すとき、**ネーベンタイプを持つモジュラー形式** が定義される。具体的には:

#### **定義 9.10（指標** $$\chi$$ **を伴うモジュラー形式）**

ディリクレ指標 $$\chi$$（法 $$N$$）と合同部分群 $$\Gamma_0(N)$$ を固定するとき、正則関数 $$f$$ が **重み** $$k$$**、レベル** $$N$$**、ネーベンタイプ** $$\chi$$ のモジュラー形式であるとは、

$$
f(\gamma \cdot z) \;=\; \chi(d)\,(c z + d)^{-k}\, f(z)
\quad
\text{(全ての }\gamma = \begin{pmatrix} a & b \\ c & d \end{pmatrix}\in \Gamma_0(N)\text{ に対して)}
$$

を満たし、各尖点で適切な成長条件（または消失条件）を満たすときにいう。

このように $$\chi(d)$$ というねじれを入れることで、フーリエ係数の算術的性質がさらに豊かになり、対応するガロア表現や相互法則といった問題に直接的に関わってきます。特に **ディリクレ** $$L$$**-関数** やそのねじれは、こうした形式の研究に自然に登場します。

### **9.2.4 オールド形式とニュー形式**

重み $$k$$、レベル $$N$$ のモジュラー形式を分類する際、レベルの小さい部分群から「持ち上げ」られる形式（**オールド形式**）と、そうではない「新しい」形式（**ニュー形式**）に分ける手法がよく使われます。

#### **定理 9.11（Atkin–Lehner による分解）**

$$\Gamma_0(N)$$（および指標 $$\chi$$）に対するモジュラー形式（あるいは尖点形式）の空間 $$M_k(\Gamma_0(N),\chi)$$ は、

$$
M_k(\Gamma_0(N),\chi)_{\text{old}}
\;\oplus\;
M_k(\Gamma_0(N),\chi)_{\text{new}}
$$

という直和分解を持つ。ここで $$M_k(\Gamma_0(N),\chi)_{\text{new}}$$ は **ニュー形式** によって張られる部分空間で、「原始的 (primitive)」な意味を持つ。

Atkin と Lehner が発見したこの分解は $$L$$**-関数** の解析やその因数分解性を理解する上で極めて重要です。各ニュー形式はHecke固有形式（固有値を持つ固有函数）を生成し、そのフーリエ係数からは深い算術データが得られます。

***

## **9.3** $$\mathrm{SL}_2(\mathbb{Z})$$ **およびその合同部分群下での変換**

### **9.3.1 合同部分群** $$\Gamma_0(N)$$**,** $$\Gamma_1(N)$$

先に定義したように、$$\Gamma_0(N)$$ や $$\Gamma_1(N)$$ は、上半平面のコンパクト化の境界（実数直線や無限遠点）上に有限個の **尖点 (cusp)** を持ちます。各尖点において、モジュラー形式の正則性（あるいは尖点形式であれば消失）を定義するために、それぞれの尖点付近の局所座標系での展開（$$q$$-展開に類似）を考えます。

* $$\Gamma_0(N)$$ は、位相幾何学的には「楕円曲線と位数 $$N$$ の巡回部分群 (cyclic subgroup)」を付加データとする構造をパラメータ化すると解釈できます。
* $$\Gamma_1(N)$$ は、位数 $$N$$ の「特別な点（生成元）」を付加する楕円曲線をパラメータ化します。

### **9.3.2 Atkin–Lehner 変換**

**Atkin–Lehner 変換** とは、レベル $$N$$ のモジュラー形式の空間に作用するある種の演算子です。各約数 $$d \mid N$$ に対して、

$$$
w_d \;=\;
\begin{pmatrix}
\alpha d & \beta \$$4pt]
\gamma N & \delta d
\end{pmatrix}
\in \mathrm{SL}_2(\mathbb{R})
$$$

という行列（$$\alpha, \beta, \gamma, \delta$$ をうまく選ぶ）を考え、これが $$\Gamma_0(N)$$ を正規化する（群を自身に移す）ようにします。重み $$k$$ の形式 $$f$$ に対して、

$$
\bigl(f \big| w_d\bigr)(z) 
\;=\; (c z + d)^{-k} \, f\bigl(w_d\cdot z\bigr)
$$

という作用が定義されます（ネーベンタイプ指標 $$\chi$$ がある場合は $$\chi(d)$$ など追加の因子が入る）。各 $$w_d$$ は位数 2（**反転**）を持ち、尖点をある規則的な方法で入れ替える性質があります。

#### **定理 9.12（Atkin–Lehner 作用の固有分解）**

演算子 $$w_d$$ は、$$M_k(\Gamma_0(N), \chi)$$（あるいはその尖点形式部分空間 $$S_k(\Gamma_0(N), \chi)$$）に対して対角化可能であり、$$\pm 1$$ の固有値を持つ。したがって、これらすべての Atkin–Lehner 変換による同時固有空間への分解が可能である。ニュー形式の空間は、これらの変換でさらに細かい性質（固有空間）に分解される場合が多い。

***

## **歴史的背景と主要な例**

1.  **アイゼンシュタイン級数**\
    最初期かつ最も重要なモジュラー形式の例が、重み $$k$$ のアイゼンシュタイン級数である:

    $$
    E_k(z)
    \;=\; 1 - \frac{2k}{B_k} \sum_{n=1}^\infty \sigma_{k-1}(n)\,q^n,
    $$

    ここで $$\sigma_{k-1}(n)$$ は $$n$$ の正の約数の $$(k-1)$$ 乗冪和を表し、$$B_k$$ は第 $$k$$ ベルヌーイ数。

    * $$E_k(z)$$ は $$\mathrm{SL}_2(\mathbb{Z})$$ の重み $$k$$ の正則モジュラー形式となる。
    * $$k>2$$ の場合、定数項が消えないため尖点形式ではない。
2.  **ラマヌジャンの** $$\Delta$$ **関数**\
    ラマヌジャンの $$\Delta$$ **関数** は、$$\mathrm{SL}_2(\mathbb{Z})$$ の重み 12 の尖点形式として最も有名である:

    $$
    \Delta(z)
    \;=\; q \prod_{n=1}^\infty (1 - q^n)^{24}
    \;=\;
    \sum_{n=1}^\infty \tau(n)\,q^n,
    $$

    ここで $$\tau(n)$$ はラマヌジャンの **タウ函数**。$$\Delta$$ は定数項を持たないため尖点形式であり、そのフーリエ係数 $$\tau(n)$$ は驚くべき算術的性質（たとえばデルigneによるヴェイ予想の証明にも関連）が知られています。
3. $$\Gamma_0(N)$$ **の例**\
   小さい $$N$$（例: $$N=4$$）の場合、$$\Gamma_0(4)$$ の基本領域を具体的に書き下すことができ、対応する尖点（$$i\infty$$ だけでなく有限有理点など）での展開を調べることでレベル 4 のモジュラー形式を系統的に構成・理解できます。これらの尖点付近での展開は、無限遠点での $$q$$-展開と似た「局所 $$q$$-展開」として扱われます。

いずれの例においても、群作用が課す機能方程式がフーリエ係数へ強い制約を与え、その結果、約数函数 $$\sigma_{k-1}(n)$$ やタウ函数 $$\tau(n)$$ のような深遠な数論的情報がその係数列に直接反映されます。

***

## **第9節のまとめ**

ここまでで、**古典的なモジュラー形式の理論** を構成する以下の要点を概観しました。

1. **正則モジュラー形式** は、上半平面上で正則かつ $$\mathrm{SL}_2(\mathbb{Z})$$ やその部分群による変換則を満たす関数として定義される。
2. **尖点形式** はすべての尖点において消失する特殊なクラスで、フーリエ係数に最も豊富な数論的情報を含む。
3. $$q$$**-展開** によって、解析的性質はべき級数の係数論へと転換され、約数和や類数などの重要な数論量が係数に表れる。
4. **レベル** と **ネーベンタイプ指標** を導入すると、$$\mathrm{SL}_2(\mathbb{Z})$$ の部分群上でより詳細な構造が得られ、ディリクレ指標やガロア表現との繋がりが生まれる。
5. **Atkin–Lehner 変換** と **オールド形式・ニュー形式** の区別は、これらのより大きな空間の分解と分類を整理し、$$L$$-関数の因数分解やHecke理論への応用に不可欠である。

ここまでの準備により、次の節では **Hecke作用素**、ニュー形式論の詳細、および **楕円曲線や** $$L$$**-関数への応用** へ踏み込むことができます。これらは現代数論の基礎をなし、最終的には **フェルマーの最終定理** のような伝説的定理の証明にも結びつきます。

***

### **さらに読みたい文献**

* J.-P. Serre, _A Course in Arithmetic_, 第7–8節.
* H. Cohen, _Number Theory, Volume II: Analytic and Modern Tools_. （特にモジュラー形式と計算的手法に関する部分）
* H. Iwaniec, _Topics in Classical Automorphic Forms_.
* T. Apostol, _Modular Functions and Dirichlet Series in Number Theory_.

これらの文献では、より解析的・幾何学的・代数的な観点からモジュラー形式を深く掘り下げ、Langlandsプログラムの文脈へと一般化する手がかりを与えてくれます。

***
