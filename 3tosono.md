# 第3節:数体とその整数環

## **イントロダクション**

\*\*フェルマーの最終定理（FLT）\*\*のような問題を現代的な代数的観点で研究するには、有理数 $$\mathbb{Q}$$ を超えて、**数体**（$$\mathbb{Q}$$ の有限拡大）を考察するのが自然です。こうした数体の算術、すなわち _因数分解_、_分岐_、_類群_ の構造は、楕円曲線・保型形式・ガロア表現といった FLT の現代的な証明に必須の役割を果たします。

歴史的には、これらの拡大を研究する方向へ進んだ主な理由として以下が挙げられます：

* 円分多項式や代数数の最小多項式などの因数分解を理解する試み。
* ディオファントス方程式の解法を目指す試みの延長（特に、フェルマーの予想である $$x^n + y^n = z^n$$ に代表される問題）。

ガウス、クンマー、デデキントらは、こうした「より大きな」数体内での**整数に似た環**を研究し始めました。そして、$$\mathbb{Z}$$ で成立していた唯一分解の法則が、より一般の環では崩れることを発見しました。これは初期の FLT への取り組みにおける大きな障壁となり、やがて数体 $$K$$ の**整数環** $$\mathcal{O}_K$$ の概念、および Dedekind 領域・類群・単数群といったより深い理論へと発展していきます。本節では、以下のトピックを紹介します。

1. $$\mathbb{Q}$$ の**代数拡大**とその性質（正規拡大、ガロア拡大、分離拡大）。
2. **整数環**と、イデアルの一意分解および Dedekind 領域としての構造。
3. **分岐理論**、付随する付値および完備化（$$p$$ 進数など）。
4. **類群**と **単数群**。最後にクンマーの研究と FLT への影響について簡単な歴史的言及を行う。

***

## **3.1** $$\mathbb{Q}$$ **の代数拡大**

### 3.1.1 有限拡大と無限拡大、正規拡大とガロア拡大

#### **直観的な概観**

**数体**とは、有理数 $$\mathbb{Q}$$ の有限次拡大 $$K$$、すなわち $$\mathbb{Q}$$ 上のベクトル空間として次元が有限な拡大を指します。典型的には、ある多項式の根（$$\sqrt{2}$$ や $$n$$ 次の原始根 $$\zeta_n$$ など）を $$\mathbb{Q}$$ に添加すると、有限拡大が得られます。無限拡大も確かに存在しますが、算術的な応用（FLT を含む）では有限拡大が重要な役割を担います。

拡大 $$K/\mathbb{Q}$$ が以下のように呼ばれるのは次の理由によります。

* **正規拡大**：これは $$\mathbb{Q}[x]$$ に属する多項式の分割体になっている場合を指します。具体的には、$$K$$ に根をもつ $$\mathbb{Q}$$ 上既約な多項式は、すべて $$K$$ 内で完全に分解（因数分解）しなければなりません。
* **ガロア拡大**：正規拡大かつ**分離拡大**である場合を指します。有理数体 $$\mathbb{Q}$$ は標数が 0 なので、分離拡大であるかどうかは常に自動的に満たされます。したがって $$\mathbb{Q}$$ に対しては、「正規拡大」はほぼ「ガロア拡大」と同義になります。

#### **主な定義と定理**

1. **有限拡大**\
   拡大 $$K/\mathbb{Q}$$ が **有限** であるとは、$$\dim_{\mathbb{Q}}(K)$$ が有限であることを言います。この次元を拡大の**次数**と呼び、$$[K : \mathbb{Q}]$$ と表します。
2. **正規拡大**\
   $$K/\mathbb{Q}$$ が **正規** であるとは、$$\mathbb{Q}$$ 上で既約な多項式のうち $$K$$ に根をもつものが、すべて $$K$$ 内で完全に分解することを言います。
3. **ガロア拡大**\
   $$K/\mathbb{Q}$$ が **ガロア拡大** とは、正規かつ分離拡大であることです。すでに述べたように $$\mathbb{Q}$$ 上では分離拡大が常に成立するため、「正規拡大」ならばガロア拡大と見なせます。

#### **具体例**

* $$\mathbb{Q}(\sqrt{2})$$\
  $$\sqrt{2}$$ を添加して得られる拡大で、次数 2 の有限拡大です。$$\sqrt{2}$$ は $$x^2 - 2$$ の根であり、この多項式は $$\mathbb{Q}(\sqrt{2})$$ 内で $$(x-\sqrt{2})(x+\sqrt{2})$$ と分解します。よって拡大は正規であり、$$\mathbb{Q}$$ が標数 0 なのでガロア拡大にもなります。
* $$\mathbb{Q}(\zeta_n)$$\
  $$\zeta_n$$ を $$n$$ 次の原始根とすると、拡大の次数はオイラーのトーシェント関数 $$\varphi(n)$$ になります。この拡大は $$\zeta_n$$ が $$x^n - 1$$ の根であり、さらに $$\mathbb{Q}(\zeta_n)$$ は円分多項式 $$\Phi_n(x)$$ の分割体となるため正規拡大、したがってガロア拡大でもあります。

### 3.1.2 生成元定理と分離拡大

#### **直観的な概観**

意外にも、任意の有限拡大 $$K$$ は **1 つの元** $$\theta$$ を添加するだけで記述できるという事実があります。これは\*\*生成元定理（Primitive Element Theorem）\*\*と呼ばれます。さらに、標数 0 の場合にはすべての既約多項式が分離的（根が重ならない）なので、ガロア拡大の構造が単純化されます。

#### **生成元定理**

> **定理（生成元定理）:**\
> $$K$$ が $$\mathbb{Q}$$ の有限拡大ならば、ある 1 つの元 $$\theta \in K$$ が存在して $$K = \mathbb{Q}(\theta)$$ と書ける。

*   **証明の概略**：\
    もし $$K = \mathbb{Q}(\alpha_1, \ldots, \alpha_m)$$ と書けるなら、ほとんど「任意に」選んだ線形結合

    $$
    \theta = \alpha_1 + c_2\alpha_2 + \cdots + c_m\alpha_m 
      \quad (c_i \in \mathbb{Q})
    $$

    によって $$K$$ が生成されます。例外となる有限個の“悪い”選択肢を除けば、適切な $$\theta$$ を簡単に見つけられることが示されます。

#### **分離拡大**

多項式 $$f(x) \in \mathbb{Q}[x]$$ が**分離的**とは、その分割体において重複根をもたないことを言います。$$\mathbb{Q}$$ は標数が 0 なので、既約多項式は自動的に分離的です。従って任意の $$\mathbb{Q}$$ の有限拡大は分離拡大となり、数体では「非分離拡大」を考慮する必要はありません。

***

## **3.2 整数環、一意分解、イデアル論**

### 3.2.1 Dedekind 領域とイデアルの因数分解

#### **直観的な概観**

$$\mathbb{Q}$$ に対しては、$$\mathbb{Z}$$ での**素因数分解が一意**であることがとても重要な性質です。一方、一般の数体 $$K$$ では、その「整数に相当する」元の集まりとして **整数環** $$\mathcal{O}_K$$ が定義されます。ところが、$$\mathcal{O}_K$$ の“元”レベルでの一意分解は必ずしも成立しません。代わりに、$$\mathcal{O}_K$$ は **Dedekind 領域**として、_イデアル_ のレベルでの一意分解が成立します。

歴史的に、$$\mathbb{Q}(\sqrt{-5})$$ などで**元レベルの一意分解が破れる**例が大きな驚きとして認識されました。クンマーが円分体における FLT の初期研究を通じて、イデアル分解や類群の概念を確立する契機となりました。

#### **定義**

1. **代数的整数**と**整数環**\
   数体 $$K$$ に属する元 $$\alpha$$ が **代数的整数** であるとは、$$\alpha$$ が整数係数のモニック多項式（最高次係数が 1 の多項式）の根であることを言います。$$K$$ のすべての代数的整数の集合を $$\mathcal{O}_K$$ と書きます。これは $$\mathbb{Z}$$-加群として自由で、そのランクは $$[K:\mathbb{Q}]$$ になります。
2. **Dedekind 領域**\
   **Dedekind 領域**とは、零因子をもたない整域であって、任意の 0 でないイデアルが素イデアルの積として一意に分解するという性質をもつものです。$$\mathcal{O}_K$$ が Dedekind 領域であることの主な特徴は次のとおりです：
   * 整閉（その体における代数的整数をすべて含む）。
   * 0 でない素イデアルは極大イデアルである。
   * 任意の 0 でない（分数）イデアルが素イデアルの積へと一意に分解する。

#### **イデアルの一意分解**

$$\mathcal{O}_K$$ のイデアル $$\mathfrak{a}$$ は、次のように一意的に分解できます。

$$
\mathfrak{a} = \mathfrak{p}_1^{e_1}\,\mathfrak{p}_2^{e_2}\,\cdots\,\mathfrak{p}_r^{e_r},
$$

ここで $$\mathfrak{p}_i$$ は 0 でない素イデアルであり、指数 $$e_i$$ は正の整数です（順序を除いて一意）。これは、$$\mathcal{O}_K$$ が UFD（唯一分解整域）でなくても、**イデアル** は唯一分解をもつということを示しており、これが現代の「イデアル論的」数論の要となっています。

### 3.2.2 Minkowski の境界と有限性定理

#### **直観的な概観**

$$\mathcal{O}_K$$ におけるイデアル分解の構造がわかったら、次の疑問は「これらの分解で現れるイデアルの“大きさ”はどの程度か？」という点です。そして、「一意分解を妨げる構造」や「類数（クラス数）」などの振る舞いは有限的に制御できるのかが焦点になります。実は、**類群**が有限群になることを示すには **Minkowski の幾何学的数論**が用いられ、「十分に大きい」凸対称体に代数的整数の格子点が必ず存在することを示します。

歴史的には、**Minkowski の定理**は代数的整数論において画期的で、イデアルのノルムに対する厳密な上界や、類群が有限になることを示す核心的な手段となりました。クンマーが FLT を円分体で部分的に進める際にも、イデアルの振る舞いを理解することが重要でした。

#### **Minkowski の凸体定理（特別形）**

> **定理（Minkowski の凸体定理）**\
> $$K$$ を $$\mathbb{Q}$$ 上の次数 $$n$$ の数体とし、実埋め込みの数を $$r$$ 個、複素埋め込みの数を $$2s$$ 個（よって $$r + 2s = n$$）とする。すると、$$\mathbb{R}^n$$ 内の凸で対称な集合で、$$K$$ に依存するある閾値を超える「十分に大きい」体積をもつものの中には、$$\mathcal{O}_K$$ の非零元（= 格子点）が必ず含まれる。

要するに、これらの埋め込みで見たときに「大きい」対称凸体には、必ず 0 でない代数的整数が入り込むというわけです。これを利用すると、非自明なイデアルのノルムがある範囲を超えないことを示すことができ、類群の有限性など、代数的整数論の諸定理が得られます。

***

## **3.3 分岐理論、付値、完備化**

### 3.3.1 判別式と分岐する素数

#### **直観的な概観**

$$\mathbb{Q}$$ から $$K$$ への拡大を考えたとき、各素数 $$p$$ が $$\mathcal{O}_K$$ で必ずしも「素のまま」になるわけではありません。代わりに次のような挙動をとります。

* **分解**：素数 $$p$$ は $$\mathcal{O}_K$$ で複数の異なる素イデアルに分解される。
* **惰性**：$$p\mathcal{O}_K$$ が素イデアルのまま変わらない（$$p$$ が $$K$$ で不分解）。
* **分岐**：$$p$$ がイデアル分解で重複度をもって現れる（高べきで現れる）。

このうち分岐は、より深い算術的現象を示唆するものです。拡大全体で分岐を総合的に測る不変量として、**判別式** $$\Delta_K$$ が存在します。素数 $$p$$ が $$\Delta_K$$ を割り切るとき、その $$p$$ は $$K$$ で**分岐**する素数となります。

#### **判別式**

$$\{\alpha_1, \ldots, \alpha_n\}$$ を $$K$$ の $$\mathbb{Q}$$-基底とします。**判別式** $$\Delta(\alpha_1, \ldots, \alpha_n)$$ は、

$$
\Delta(\alpha_1, \ldots, \alpha_n) 
= \det\Bigl(\mathrm{Tr}_{K/\mathbb{Q}}(\alpha_i\,\alpha_j)\Bigr)_{1 \le i,j \le n}
$$

（符号を除く）として定義されます。もし $$\{\alpha_1, \ldots, \alpha_n\}$$ が（$$\mathbb{Z}$$-加群として）整数環 $$\mathcal{O}_K$$ の**整基底**を成すならば、この行列式は $$\Delta_K$$$$=$$**数体** $$K$$ **の判別式** と呼ばれます。素数 $$p$$ が $$\Delta_K$$ を割り切るなら、その $$p$$ は $$K$$ において**分岐**することになります。

### 3.3.2 有限素点と無限素点における完備化

#### **直観的な概観**

$$\mathbb{Q}$$ を「無限の素点」で完備化すると実数体 $$\mathbb{R}$$ を得たり、ある有限の素点（素数 $$p$$）で完備化すると $$\mathbb{Q}_p$$ を得たりするように、一般の数体 $$K$$ においても、対応する**素点**（素イデアルや実・複素埋め込み）に対して完備化を行うことができます。これは局所的な視点から数体を捉えるときに極めて重要です。

* **有限素点**：$$\mathcal{O}_K$$ の素イデアル $$\mathfrak{p}$$ は、$$\mathbb{Z}$$ のある素数 $$p$$ を上に持ち上げたものです。$$\mathfrak{p}$$ での完備化 $$K_{\mathfrak{p}}$$ は $$\mathbb{Q}_p$$ の有限次拡大となる**局所体**になります。
* **無限素点**：$$K$$ の実埋め込み $$\sigma: K \hookrightarrow \mathbb{R}$$ は「実の素点」、非実埋め込み $$\sigma: K \hookrightarrow \mathbb{C}$$ は共役ペアで「複素の素点」と呼ばれます。これらを通じて得られる完備化は $$\mathbb{R}$$ もしくは $$\mathbb{C}$$ になります。

#### **付値と完備化**

**付値** $$v$$ は「ある素イデアルが数体の元をどれだけ割り切るか」を定量化する概念です。素イデアル $$\mathfrak{p}$$ に対しては離散付値 $$v_{\mathfrak{p}}$$ が対応し、$$K$$ をその付値で完備化すると $$\mathbb{Q}_p$$ と同様に局所体を得ます。数論では、素点ごとの局所的解析（局所理論）と、すべての素点を合わせた大域的解析（大域理論）との組み合わせが重要で、FLT の現代的な手法（局所から大域へ、Local-to-Global の原理）においても不可欠です。

***

## **3.4 類群と単数群**

### 3.4.1 類群の計算と FLT との関連

#### **直観的な概観**

$$\mathbb{Z}$$ では任意のイデアルが 1 つの元（整数）で生成されますが、一般の整数環 $$\mathcal{O}_K$$ では主イデアルとは限りません。**類群** $$\mathrm{Cl}(K)$$ は、「主イデアルにならないイデアル」がどの程度存在するかを測るもので、その大きさ（類数、$$h_K$$）が**主イデアル**となるイデアルがどれくらい少ないかを示します。

類群が自明である（類数 $$h_K = 1$$）場合、$$\mathcal{O}_K$$ は **PID（主イデアル整域）** となり、しばしば（必ずではありませんが）元の唯一分解整域となることが多いです。

歴史的には、**クンマー**が円分体 $$\mathbb{Q}(\zeta_p)$$ の類群を詳細に調べ、FLT との関連を見いだしました。具体的には、もしある素数 $$p$$ に対して、該当する円分体の類数に関して特定の条件（“規則的”である）が成り立てば、$$p$$ 乗の FLT が成り立つことを示したのです。これは**正則素数**の概念として知られ、19 世紀における FLT への系統的アプローチの一つでした。

#### **定義：イデアル類群**

1. **分数イデアル**：分母を許容したイデアルの一般化で、任意の非零イデアルが可逆になるように拡張したもの。
2.  **類群** $$\mathrm{Cl}(K)$$：$$\mathcal{O}_K$$ の分数イデアル全体の集合において、**主イデアル**（$$\alpha \mathcal{O}_K, \, \alpha \in K^\times$$）全体を同値類と見なして商をとった群：

    $$
    \mathrm{Cl}(K) \;=\; \frac{\{\text{分数イデアル}\}}{\{\alpha \mathcal{O}_K : \alpha \in K^\times\}}.
    $$

    * **類数** $$h_K$$ を $$\lvert \mathrm{Cl}(K) \rvert$$ で表す。Minkowski の定理を用いると、この類群が**有限**群であることが示される。$$h_K = 1$$ ならば $$\mathcal{O}_K$$ は PID である。

#### **FLT との歴史的関連**

クンマーは、$$p$$ が「正則素数」（$$\mathbb{Q}(\zeta_p)$$ の類数を $$p$$ が割らない、などの特定の条件）であれば、指数 $$p$$ の FLT が成立することを示しました。これは無数の素数について FLT が正しいことを証明するものでしたが、すべての素数については未解決のままでした。

### 3.4.2 Dirichlet の単数定理と幾何学的解釈

#### **直観的な概観**

$$\mathbb{Z}$$ では単数（可逆元）は $$\pm 1$$ だけです。ところが、$$\mathcal{O}_K$$ でははるかに複雑な単数群 $$\mathcal{O}_K^\times$$ をもち得ます。**Dirichlet の単数定理**が、これを有限群（根元）と自由 Abel 群の直積として完全に特徴づけるのです。自由部分のランクは、実埋め込みの個数 $$r$$ と複素埋め込みのペア数 $$s$$ によって決まり、$$r + s - 1$$ となります。

#### **Dirichlet の単数定理**

> **定理（Dirichlet の単数定理）:**\
> $$K$$ を、実埋め込みの数を $$r$$、複素埋め込みのペア数を $$s$$（よって $$r + 2s = [K:\mathbb{Q}]$$）とする数体とする。このとき
>
> $$
> \mathcal{O}_K^\times \;\cong\; \mu(K) \;\times\; \mathbb{Z}^{\,r + s - 1}
> $$
>
> が成り立つ。ここで $$\mu(K)$$ は $$K$$ が含む有限個の根元（1 の根）の群であり、これは有限群である。

**幾何学的解釈**：\
**ログ埋め込み**と呼ばれる写像で、単数 $$\alpha$$ を $$\mathbb{R}^{r+s}$$ へ写しこむと、積の公式から 1 つの線型関係が得られ、$$(r+s-1)$$ 次元の超平面上の格子（離散部分群）を形成します。これがちょうど「有限なねじれ部分」（根元）と「階数 $$r+s-1$$ の自由 Abel 群」の直積構造に対応します。

この定理は、数体での指数型のディオファントス方程式や除法性の問題を扱う際に基礎的役割を果たし、フェルマーの最終定理周辺の問題でも重要な道具立てとなります。

***

## **例と歴史的補足**

1. **円分体とクンマーのイデアル論**
   * 素数 $$p$$ に対する **円分体** $$\mathbb{Q}(\zeta_p)$$ では、整数環は $$\mathbb{Z}[\zeta_p]$$ となります。クンマーはここで唯一分解が破れる可能性を発見し、それを補うために**イデアル分解**と**類群**の概念を導入しました。
   * FLT への直接的な影響としては、類群が十分「小さい」かどうかを検討することで、$$p$$ 乗 FLT の解の存在を排除できる（正則素数の場合）という戦略を示しました。
2. **具体的な類数の例**
   * $$\mathbb{Q}(\sqrt{-5})$$：整数環は $$\mathbb{Z}[\sqrt{-5}]$$ で類数は 2 となり、元の唯一分解が成立しない（例：$$6 = 2 \cdot 3 = (1 + \sqrt{-5})(1 - \sqrt{-5})$$）ことで有名です。
   * $$\mathbb{Q}(\sqrt{-1})$$（あるいは $$\mathbb{Q}(i)$$）：ここでは $$\mathcal{O}_K = \mathbb{Z}[i]$$ となり、類数が 1 のため PID（実際には UFD）です。同様に $$\mathbb{Q}(\sqrt{-2})$$ も類数 1 です。
3. **FLT への初期アプローチ**
   * ワイルズの証明以前、円分体の類群を総合的に調べることで「すべての指数」について FLT を解決できるのではないかと期待されていました。事実、クンマーは無限に多くの素数 $$p$$ について FLT を証明しましたが、全ての素数をカバーするには至りませんでした。
   * その後、類群・分岐・ガロア表現といった構造をより深く研究する道筋が開拓され、最終的にはワイルズの証明へと繋がっていきます。

***

## **要点のまとめ**

1. **数体**
   * $$\mathbb{Q}$$ の有限次拡大。高度な算術問題を考える上で自然な舞台を提供する。
2. **整数環と Dedekind 領域**
   * 整数環 $$\mathcal{O}_K$$ は数体における「整数」。
   * 元レベルの唯一分解が必ずしも成り立たないが、Dedekind 領域として**イデアル**の唯一分解が成立する。
3. **分岐と判別式**
   * 素数 $$p$$ は数体で分解・惰性・分岐する。
   * 判別式 $$\Delta_K$$ は分岐を制御する重要な不変量であり、$$\Delta_K$$ を割る $$p$$ は分岐する。
4. **類群**
   * $$\mathrm{Cl}(K)$$ は「イデアルが主イデアルかどうか」のずれを測る群で、有限群である。
   * これが自明（類数 1）なら $$\mathcal{O}_K$$ は PID となり、多くの場合に UFD となる。
5. **Dirichlet の単数定理**
   * $$\mathcal{O}_K^\times$$ の構造を有限なねじれ部分（根元）と自由 Abel 群（階数 $$r+s-1$$）の直積として完全に解明する。

これらは **代数的整数論** の基礎をなし、**フェルマーの最終定理**の現代的アプローチ（局所から大域へ、類体論、ガロア表現など）でも欠かせない道具立てとなっています。

***

**第3節 終了**
