# 第17節:環の局所的・大域的性質

現代の数論、特に**ガロワ表現の変形**や**ヘッケ環**を扱う際には、さまざまな環論的性質が頻繁に登場します。たとえば「ネーター（Noetherian）」「コーエン＝マコーレイ（Cohen–Macaulay）」「ゴレンシュタイン（Gorenstein）」といった性質は、幾何学的・算術的な解釈を持ち、$$(R = T)$$型の同型定理（ガロワ表現の変形環とヘッケ環が同型になるような定理）の証明において重要な役割を果たします。

ここで主要な問いは次のとおりです。

> **環の局所的な性質（例：完成や次元）と、大域的な性質（例：スペクトラム全体の振る舞い、正準加群の存在など）は、どのように相互作用して同型構成や証明に寄与するのか？**

端的に言えば、ネーター性・コーエン＝マコーレイ性・ゴレンシュタイン性といった諸性質は、環をホモロジー論的・幾何学的に「良い振る舞い」に保ちます。こうした性質があると、病的な状況が回避され、双対定理（duality theorem）がスムーズに成立しやすくなります。また、次元や深さ（depth）の管理が容易になるため、数論的応用において変形環とヘッケ環をうまく対応づける際に不可欠です。

以下では、このような考え方を体系的に展開します。

***

## 17.1 ネーター環、次元、および完成

### 17.1.1 ネーター環とヒルベルトの基底定理

1.  **定義（ネーター環）**\
    可換環 $$R$$ が\*\*ネーター環（Noetherian ring）\*\*と呼ばれるのは、以下の同値な条件のいずれか（実はすべて）を満たす場合です。

    * $$R$$ におけるイデアルの上昇列がすべて停止する（**上昇鎖条件**）。
    * $$R$$ の任意のイデアルが有限生成である。
    * （$$R$$ が体上の環である場合）多項式環 $$R[x_1, \dots, x_n]$$ がヒルベルトの基底定理を満たす（つまり、これもネーター環である）。

    **直観的な見方：**\
    $$R$$ がネーター環であるとは、「イデアルが無限に暴走しない」という有限生成的な制約がある、ということです。この性質のおかげで、イデアルの根基分解（primary decomposition）や次元論をはじめとする多くの基本的な構成が可能になり、無限に入り組んだ状況が回避されます。
2.  **定理（ヒルベルトの基底定理）**\
    可換環論の基本定理として次が知られています。

    > **ヒルベルトの基底定理：**\
    > もし $$R$$ がネーター環ならば、多項式環 $$R[x]$$ もネーター環である。

    **証明の概略：**

    * $$R$$ 上のイデアルがすべて有限生成であると仮定すると、$$R[x]$$ のイデアルについても、次数に関する帰納法などを用いて有限生成性を示すことができる。
    * これは「多項式変数を加えてもネーター性が保たれる」という強力な結果です。
3. **歴史的注釈：**\
   「ネーター環」という名称は、1921年の画期的な論文で環の構造論における上昇鎖条件の重要性を示した**エミー・ネーター** (Emmy Noether) に敬意を表して名づけられました。
4. **例（多項式環）**
   * 体 $$k$$ 上の多項式環 $$k[x_1, x_2, \dots, x_n]$$ はネーター環である。
   * ゆえに、有限生成イデアルで割った商環 $$k[x_1, \dots, x_n]/(f_1,\dots,f_r)$$ もネーター環になる。

***

### 17.1.2 クルル次元

1.  **定義（クルル次元）**\
    環 $$R$$ の\*\*クルル次元（Krull dimension）\*\*とは、$$R$$ 内の素イデアルの厳密な包含鎖

    $$
    \mathfrak{p}_0 \subsetneq \mathfrak{p}_1 \subsetneq \cdots \subsetneq \mathfrak{p}_n
    $$

    の長さ $$n$$ の最大値（上限）で定義されます。つまり、

    $$
    \dim(R) \;=\; \sup \bigl\{ n \;\big|\; \mathfrak{p}_0 \subsetneq \mathfrak{p}_1 \subsetneq \cdots \subsetneq \mathfrak{p}_n \bigr\}.
    $$

    これは可換代数における幾何学的な「次元」の概念を一般化するものです。
2. **例と直観：**
   * 多項式環 $$\mathbb{C}[x_1, \dots, x_n]$$ の次元は $$n$$ となります。幾何学的には、$$\operatorname{Spec}(\mathbb{C}[x_1, \dots, x_n])$$ は $$\mathbb{C}^n$$（アファイン $$n$$ 次元空間）に対応し、その「次元」が $$n$$ であることを意味します。
   * **整数環の有限拡大**（例：代数的整数環 $$\mathcal{O}_K$$）のように、$$\mathbb{Z}$$ からの有限生成環は次元が 1 となる場合が多い。これは $$\operatorname{Spec}(\mathcal{O}_K)$$ が「算術的曲線（1 次元）」として扱えることを反映しています。
3. **次元が重要な理由：**\
   次元は、可換代数と幾何学のかかわりを繋ぐ基本概念です。数論においては、変形環やヘッケ環の次元を制御することが、$$(R = T)$$ 型定理の証明で両者を一致させる際に非常に重要になります。

***

### 17.1.3 完成と $$\mathfrak{m}$$-進位相

1. **局所環と** $$\mathfrak{m}$$**-進位相**\
   **局所環（local ring）** $$(R, \mathfrak{m})$$ とは、ただ1つの極大イデアル $$\mathfrak{m}$$ をもつ環のことです。$$R$$ に対し、$$\mathfrak{m}$$-進位相を「$$\mathfrak{m}^n$$ が 0 の近傍系をなす」として導入します。これは、$$\mathfrak{m}$$-進位相での収束が「$$\mathfrak{m}$$ の高べきの中に次第に入っていく」ことを意味する、ということです。
2.  **定義（局所環の完成）**\
    $$\mathfrak{m}$$ 進位相における $$R$$ の**完成（completion）** $$\widehat{R}$$ は、

    $$
    \widehat{R} \;=\; \varprojlim_{n} R / \mathfrak{m}^n
    $$

    と定義されます。これは商環 $$R/\mathfrak{m}^n$$ の逆系（逆極限）として得られ、直観的には「$$\mathfrak{m}$$ のべきに関する形式的冪級数」として捉えられます。
3. **例：**
   * $$p$$**-進整数**: $$R = \mathbb{Z}$$ で $$\mathfrak{m} = (p)$$ とすると、完成環 $$\widehat{R}$$ は $$\mathbb{Z}_p$$ になり、「$$p$$ の冪に関する形式的展開」を持つ対象として理解できます。
   * **冪級数環**: $$k[x_1, \dots, x_n]_{(x_1,\dots,x_n)}$$（$$(x_1,\dots,x_n)$$ で局所化した多項式環）を考えると、その完成は形式的冪級数環 $$k[[x_1,\dots,x_n]]$$ になります。
4. **主な性質：**
   * $$R$$ が**ネーター局所環**であれば、その完成 $$\widehat{R}$$ もネーター局所環になる。
   * $$R$$ のクルル次元は $$\widehat{R}$$ と等しくなる。
   * 完成をとる操作は、$$\mathfrak{m}$$ の近傍構造を「ズームイン」して見ることで、変形論において極大イデアル近傍の「無限小変形」を捉える際に決定的に重要です。

***

## 17.2 コーエン＝マコーレイ性とゴレンシュタイン性

### 17.2.1 コーエン＝マコーレイ環

1. **定義（深さとコーエン＝マコーレイ）**\
   **ネーター局所環** $$(R,\mathfrak{m})$$ に対し、$$R$$ の\*\*深さ（depth）\*\*は、$$\mathfrak{m}$$ に含まれる最長の「正則列（regular sequence）」の長さとして定義されます。ここで、列 $$(x_1,\dots,x_r)$$ が正則列であるとは、次のような条件を満たすことをいいます。
   * $$x_1$$ は $$R$$ において零因子でない。
   * $$x_2$$ は $$R/(x_1)$$ において零因子でない。
   * …以下同様に、$$x_{i+1}$$ は $$R/(x_1,\dots,x_i)$$ において零因子でない。
   *   局所環 $$(R, \mathfrak{m})$$ が\*\*コーエン＝マコーレイ（Cohen–Macaulay）\*\*であるとは、

       $$
       \operatorname{depth}(R) \;=\; \dim(R)
       $$

       が成立することをいう。
   * 同値な言い方として、コーエン＝マコーレイ環では、任意の**パラメータ系（system of parameters）**（$$\mathfrak{m}$$-主要イデアルを生成する最小元集合）が正則列になっている。
2. **直観的な見方：**\
   コーエン＝マコーレイ性とは、「次元に見合った最大の深さをもつ」ことを意味し、埋め込み成分（embedded components）などが生じにくい「良い」環を指します。幾何学的にも、コーエン＝マコーレイ多様体・スキームは次元論・コホモロジー論が扱いやすいという特徴をもちます。
3. **例：**
   * **正則局所環**（例：$$k[[x_1,\dots,x_n]]$$）は、極大イデアルを生成する元が正則列になっているため、コーエン＝マコーレイです。
   * **正則列による商**: $$A = k[[x_1,\dots,x_n]]/(f_1,\dots,f_r)$$ で、$$f_1,\dots,f_r$$ が正則列をなすとき、$$A$$ はコーエン＝マコーレイ環となります。
   * 逆に、コーエン＝マコーレイでない環は、次元よりも深さが低くなる典型的な「特異性」や埋め込み素イデアルを持つなどの現象を示します。

***

### 17.2.2 ゴレンシュタイン環

1. **定義（ゴレンシュタイン局所環）**\
   ネーター局所環 $$(R,\mathfrak{m})$$ が**ゴレンシュタイン（Gorenstein）であるとは、**$$R$$ **を** $$R$$**-加群とみなしたときの入射次元**が有限である、ということです。あるいは同値な言い方として、
   * $$R$$ がコーエン＝マコーレイである。
   * かつ「双対化」を担う\*\*正準加群（canonical module）\*\*または正準複体（dualizing complex）が存在し、局所的なポアンカレ双対性のような性質を満たす。\
     という形で理解することもできます。
2. **正準加群／双対化複体：**
   * 幾何学的には、ゴレンシュタイン局所環は「最上次の微分形式」に相当するような「正準加群」をもち、正規多様体であればそれが幾何学的な双対性に対応します。
   * より代数的には、$$\operatorname{Ext}^i_R(k,R)$$（$$k = R/\mathfrak{m}$$）が、あるひとつの $$i$$ を除いてすべて消える（零）という性質として特徴づけられます。これは、可微分多様体が「上次元でのみ非自明なコホモロジーをもつ」という類推に似ています。
3. **主な性質と例：**
   * **正則局所環**（例：$$k[[x_1,\dots,x_n]]$$）はゴレンシュタイン環の代表例です。
   * $$R$$ がゴレンシュタイン環かつ $$\{f_1,\dots,f_r\}$$ が正則列であれば、商 $$R/(f_1,\dots,f_r)$$ も状況によってはゴレンシュタイン性を継承し、双対性が保たれる場合があります。
   * 数論的には、ゴレンシュタイン環はしばしば**ガロワ表現のユニバーサル変形環**として現れます。ゴレンシュタイン性は双対性に関する豊富な構造を与え、最終的に $$(R = T)$$ の証明で使われる「パッチング引数（patching argument）」の決定的ステップとなります。
4. **数論で重要となる理由：**\
   特にゴレンシュタイン性は、ガロワ表現の変形環がヘッケ環と「ローカルに」同型になるかどうかを判断する際に、双対性の観点から強い制約を与えます。変形環がゴレンシュタインであることは、「余次元」や「双対モジュール」の振る舞いをしっかり把握できることを意味し、最終的な $$(R = T)$$ 型同型を導く鍵となります。

***

## 17.3 「$$(R = T)$$」型定理への応用

### 17.3.1 どのように環論的性質が同型を保証するか

**フェルマーの最終定理**やそれを含む多くの結果の証明では、「局所的データと大域的データを繰り返し貼り合わせる（patching）」という戦略を使い、

$$
R_\mathrm{def} \;\cong\; \mathbf{T}
$$

という形の同型を示すことが多いです。ここで

* $$R_\mathrm{def}$$ はあるガロワ表現の\*\*（局所）ユニバーサル変形環\*\*を表し、そのガロワ表現の持ちうる「持ち上げ（リフト）」をパラメータ化する環です。
* $$\mathbf{T}$$ は\*\*（局所化・完成を施した）ヘッケ環\*\*であり、モジュラー形式空間に作用するヘッケ作用素を符号化する環です。

この同型を示すには、以下の諸点がしばしばカギとなります。

1. **クルル次元：**\
   $$\dim(R_\mathrm{def})$$ と $$\dim(\mathbf{T})$$ が一致すること。直観的には、両環が「同じ自由度（パラメータの数）」を持つ必要があります。
2. **完成（完備性）：**\
   $$R_\mathrm{def}$$ と $$\mathbf{T}$$ が同じ極大イデアル $$\mathfrak{m}$$ による完備化を介して比較可能であること。変形を「無限小レベル」で比較し、両者が一致するようにするには、局所的な完備化の考え方が不可欠です。
3. **コーエン＝マコーレイ性とゴレンシュタイン性：**\
   これらのホモロジー論的整合性が重要で、
   * 両者がゴレンシュタイン環であるとき、次数や Ext 群/Tor 群のふるまいから、ある種の「対称性」が生じます。
   * 特に次元が一致し、かつ**全射**な環準同型が与えられたとき、ゴレンシュタイン性によって**単射**であることも導かれ、結果的に同型を得やすくなります。

### 17.3.2 モジュラー曲線とヘッケ環の幾何学との関連

1. **モジュラー曲線における大域・局所相互作用：**
   * モジュラー形式は（モジュラー曲線やその整数モデル上の）線束の大域切断として理解できます。
   * ヘッケ作用素はこれらモジュラー形式の空間上に作用し、ヘッケ環の極大イデアル $$\mathfrak{m}$$ で局所化することは、対応するガロワ表現（アイゼンシュタイン系列や固有形式）が生み出すイデアル $$\mathfrak{m}$$ を「局所的に見る」ことに相当します。
2. **ヘッケ環と** $$\widehat{\mathbf{T}}_{\mathfrak{m}}$$**：**
   * $$\mathbf{T}$$ を $$\mathfrak{m}$$ で局所化し、その後完備化して得られる $$\widehat{\mathbf{T}}_{\mathfrak{m}}$$ は、ユニバーサル変形環 $$R_\mathrm{def}$$ の局所構造に対応する局所環となります。
   * $$\widehat{\mathbf{T}}_{\mathfrak{m}}$$ がゴレンシュタイン（あるいはコーエン＝マコーレイかつ正準加群をもつ）であることを示すことは、$$(R_\mathrm{def})$$ との照合にとってしばしば決定的なポイントとなります。

以上のように、局所環での完成・次元論・ホモロジー的性質（コーエン＝マコーレイ、ゴレンシュタイン）を総合的に扱うことが、「モジュラー曲線の幾何学」と「ガロワ表現の局所的変形論」を結びつける中核となっており、$$(R = T)$$ 型定理の成立を支えています。

***

## 歴史的・概念的補足

1. **ネーターからグロタンディークへ：**
   * **エミー・ネーター**は、イデアルに対する上昇鎖条件を体系的に導入することで、環論を大きく進展させました。
   * **ヴォルフガング・クルル**は、素イデアルの列を用いて次元という概念を確立し、幾何と代数の橋渡しをしました。
   * **グロタンディーク**は、これらの考え方をスキームや層、導来関手の理論にまで拡張し、フェルマーの最終定理の現代的証明などが展開される舞台を整備しました。
2. **コーエン＝マコーレイやゴレンシュタインの幾何学的背景：**
   * もともとこれらの性質は、代数曲面や高次元多様体の**特異点**を理解するために研究されてきました。
   * \*\*セール（Serre）やグロタンディーク（Grothendieck）\*\*の業績によって、深さ・局所コホモロジー・双対理論などが幾何学的にも自然に解釈されるようになりました（例：コヒーレント層のセール双対、可換環論における局所双対など）。
3. **具体例／計算事例：**
   * **低次元の変形環**：たとえば、**メイザー（Mazur）の制御定理**や**ワイルズ（Wiles）の定理**の証明過程では、低次元でのユニバーサル変形環が具体的に計算され、それがゴレンシュタイン環になることなどが確認されています。
   * **ヘッケ環**：固定した重み・レベルのモジュラー形式空間に作用するヘッケ環を、ある極大イデアル $$\mathfrak{m}$$ で局所化してその構造を詳しく調べると、モジュラー曲線の幾何学（あるいはシムラ曲線の幾何学）と局所・大域双対性を用いてゴレンシュタイン性を示すことができる場合があります。

***

## まとめと今後の展望

1. **ネーター性・クルル次元・完成**\
   環の局所的・大域的な現象を結びつける際の基本となる概念です。イデアルの有限生成性や局所環の完成は、変形論や大域幾何学との対応を考えるうえで不可欠です。
2. **コーエン＝マコーレイ性・ゴレンシュタイン性**
   * **コーエン＝マコーレイ**: 環の「深さ」が「次元」に一致し、埋め込み素イデアルなどの病的現象が起こりにくいことを保証します。
   * **ゴレンシュタイン**: コーエン＝マコーレイ性に加えて正準加群が存在し、双対理論がうまく働くという強力な枠組みを与えます。
3. $$(R = T)$$ **型定理への応用**
   * ユニバーサル変形環 $$R_\mathrm{def}$$ と、局所化・完成したヘッケ環 $$\mathbf{T}$$ がこれらの性質（次元、完備性、ゴレンシュタイン性など）を共有しているとき、両者間に与えられる全射な環準同型がしばしば同型へと高められます。
   * このような同型は、**フェルマーの最終定理**や\*\*モジュラリティ持ち上げ定理（Modularity Lifting Theorem）\*\*など、代数的整数論と保型形式論を結びつける多くの深遠な結果の基盤となっています。

続く節・節では、これらの抽象的な環論的性質が具体的にどのように証明に現れるかを見ていきます。特に、**パッチング引数**や**局所から大域への原理**を用いたモジュラー曲線・ガロワ表現の場面で、幾何（モジュラー曲線の構造など）と代数（局所環・完成・ホモロジー的性質）の対話がどのように強力な結果をもたらすかが示されます。このように、楕円曲線・モジュラー形式・ガロワ表現という三つ組の背後には、局所環論と大域幾何学を密接に結びつける豊かな理論が存在するのです。

以上が、第17節の内容の拡張版となります。次節以降では、ここで取り上げた環の性質が実際の証明（特に $$(R = T)$$ 型定理の証明）の中でどのように登場し、どのように活用されるかを具体的に見ていくことになるでしょう。
