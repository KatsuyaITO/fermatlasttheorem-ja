# 第18節:層,スキーム,コホモロジー

現代的な代数幾何学では、**層**(sheaves)、**スキーム**(schemes)、そして**コホモロジー**(cohomology)が、幾何学的問題を代数的・位相的手法で統一的に研究するための言語として中心的な役割を果たしている。これは、局所的なデータを記述し、それを大域的に貼り合わせる枠組みを与えることで、数体の整数環などの環上で定義される曲線、曲面、さらには高次元多様体に関する精緻な問題を扱う強力な道具を提供する。これらの概念は、楕円曲線やモジュラー曲線、さらにその幾何を特徴づけるモジュライ空間の研究において基盤的な位置づけにあり、フェルマーの最終定理の現代的な証明にも大きく貢献している。

この節では以下の内容を扱う:

1. **第18.1節**では、環のスペクトラムの概念から始め、スキームの定義へと進み、スキームの射やファイバ積を取り上げる。
2. **第18.2節**では、**層コホモロジー**を取り上げ、Čechコホモロジーと導来関手による定義の両方を概観し、降下理論やモジュライ問題への応用を示す。
3. **第18.3節**では、**交叉理論**の概観として、除法群(ディバイザ)や交叉数、および局所的な寄与がどのように算術曲面や高さペアリングの文脈で用いられるかを説明する。

この節を読み終えると、次の点が理解できるはずである:

* **スキーム**が従来の代数多様体をいかに一般化するか。
* **層コホモロジー**が局所データを大域的に貼り合わせる際の障害をどのように測るか。
* **交叉理論**が算術曲面上での交叉数や高さの研究において、数論的な不変量をどのように導き出すか。

***

## 18.1 スキーム論の基本的な概念

### 18.1.1 環のスペクトラムから幾何学的対象へ

**動機と直観的イメージ**\
古典的には、体 $$k$$ 上の代数多様体は、$$k[x_1, \dots, x_n]$$ の多項式方程式の解集合として定義されていた。しかし、時間を経るにつれ、数体の整数環など、より一般的な「底環」に対しても同様に扱いたいという要求が高まった。その発展の最終的な到達点が**スキーム**の概念であり、これは「多様体」の概念をより柔軟で一般的な枠組みへと拡張したものである。

> **定義 18.1.1（環のスペクトラム）**\
> 単位元をもつ可換環 $$R$$ に対して、$$R$$ の**スペクトラム** (spectrum) $$\mathrm{Spec}(R)$$ とは、$$R$$ のすべての素イデアルの集合として定義される。
>
> *   **ザリスキー位相**は、あるイデアル $$I \subset R$$ に対し
>
>     $$
>     V(I) \;=\; \{\mathfrak{p} \in \mathrm{Spec}(R) : I \subseteq \mathfrak{p}\}
>     $$
>
>     の形で表される集合を閉集合とすることで定められる。つまり、$$\mathrm{Spec}(R)$$ の点は $$R$$ の素イデアルを「表す」ものである。

*   **具体例**\
    $$R = k[x]$$（ここで $$k$$ は代数閉体）とすると：

    1. $$(0)$$ は $$k[x]$$ が整域なので素イデアルである。
    2. $$(x - a)$$ の形の極大イデアルは、$$k$$ 上の「点」$$a$$ を表す。
    3. より一般には、任意の素イデアルは $$k[x]$$ における既約多項式を生成するイデアルを対応づける。

    したがって $$\mathrm{Spec}(k[x])$$ は「直線」のように可視化できるが、$$(0)$$ のような「総称的な点」(generic point) も含むことに注意が必要である。

> **定義 18.1.2（構造層）**\
> $$X = \mathrm{Spec}(R)$$ とする。**構造層** $$\mathcal{O}_X$$ とは、$$X$$ の各開集合 $$U \subseteq X$$ に対して、素イデアルで局所化した $$R$$ に由来する「局所的に定義された関数」の環 $$\mathcal{O}_X(U)$$ を割り当てる層のことである。

この構造層を備えた $$\mathrm{Spec}(R)$$ は、**局所環付き空間**(locally ringed space) の例となる。これらの局所データを貼り合わせて得られるのがスキームの一般的な定義である。

> **定義 18.1.3（スキーム）**\
> **スキーム**とは、局所環付き空間 $$(X, \mathcal{O}_X)$$ であって、$$X$$ の各点には、それを含む開集合が存在し、その開集合がある可換環 $$R$$ に対して $$\mathrm{Spec}(R)$$ と局所環付き空間として同型になるようなものをいう。

このようにしてスキームは、従来の代数多様体をすべて含みつつ、零因子を含むような非可換的（正確には非既約的あるいは非既約成分がある）あるいは冪零元をもつような（非縮退な）スキームをも扱うことができ、さらに体以外の環（例：数体の整数環）上でも整合的に定義できる。

***

### 18.1.2 スキームの射とファイバ積

この枠組みで「幾何学を行う」ためには、スキームの間の射が必要となる。スキームの射 $$f: X \to Y$$ は、位相空間としての連続写像に加え、層の準同型を整合的に与える構造であり、素イデアルの対応を反映している。

> **定義 18.1.4（スキームの射）**\
> スキームの射 $$f : X \to Y$$ とは、まず位相空間としての連続写像 $$X \to Y$$ が与えられ、さらに $$Y$$ の開集合 $$V$$ ごとに、$$\mathcal{O}_Y(V)$$ から $$\mathcal{O}_X(f^{-1}(V))$$ への環準同型が誘導されるようなものをいう。
>
> * 代数的な言い方をすると、局所的には $$X \cong \mathrm{Spec}(A)$$ 、$$Y \cong \mathrm{Spec}(B)$$ のとき、環準同型 $$B \to A$$ で与えられる。

**ファイバ積**\
スキームの圏の特筆すべき性質として、**ファイバ積**（pullback）が存在することが挙げられる。これは通常の幾何での直積（デカルト積）を一般化した概念である。

> **定理 18.1.5（ファイバ積の存在）**\
> もし $$f: X \to Z$$ と $$g: Y \to Z$$ がスキームの射であれば、スキーム $$X \times_Z Y$$ が存在して、射 $$\pi_X : X \times_Z Y \to X$$ と $$\pi_Y : X \times_Z Y \to Y$$ を備え、プルバック（引き戻し）の普遍性を満たす。

直観的には、$$X \times_Z Y$$ は「$$Z$$ 上で $$X$$ と $$Y$$ を貼り合わせた」オブジェクトである。これは降下理論やモジュライ空間の構成など、より進んだ話題で不可欠な道具となる。

**歴史的背景**\
スキームの言語は、主にアレクサンダー・グロタンディークによって1950年代から1960年代にかけて開発され、『Éléments de Géométrie Algébrique (EGA)』や『Séminaire de Géométrie Algébrique (SGA)』で体系化された。グロタンディークの構想は数論と代数幾何学を橋渡しし、フェルマーの最終定理を含む現代の数論の進展に不可欠な幾何学的枠組みを提供している。

***

## 18.2 代数曲線上の層コホモロジー

### 18.2.1 Čechコホモロジーと導来関手コホモロジー

**層コホモロジーの動機と概要**\
位相空間（あるいはスキーム） $$X$$ 上の**層** $$\mathcal{F}$$ は、開集合 $$U \subseteq X$$ に対して「局所切断」の集合（あるいは群、環など）$$\mathcal{F}(U)$$ を与え、重なり合う部分で両者が整合するような構造を定める。局所的に定義した切断を大域的に貼り合わせようとしたときに生じる障害は、正確に**コホモロジー群** $$H^i(X, \mathcal{F})$$ によって測られる。

1. **Čechコホモロジー**
   * $$X$$ の開被覆 $$\{U_i\}$$ をとり、その有限交差 $$U_{i_0} \cap U_{i_1} \cap \dots$$ 上の切断からなる「コチェイン」(cochain) を作る。その後、「コサイクル」(cocycle) と「コバウンダリ」(coboundary) を交互和を使って定義し、コサイクルがコバウンダリとは限らないことの「ズレ」をコホモロジーとして捉える。
   * **有用性**: Čechコホモロジーは直感的・幾何学的であり、特に曲線上の線束や主バンドルなどの具体的な場合に計算しやすい。射影多様体や可換コヒーレント層など「良い性質」をもつ空間・層では、導来関手コホモロジーと一致することが知られている。
2. **導来関手コホモロジー**
   * グロタンディークの視点では、$$H^i(X, \mathcal{F})$$ は大域切断関手 $$\Gamma(X,-)$$ の $$i$$-次**右導来関手**(right derived functor) とみなされる。
   * **利点**: デ・ラームコホモロジー、エタールコホモロジー、クリスタリンコホモロジーなど、さまざまなコホモロジー理論を一つの統一的枠組みで扱いやすくなる。また、導来圏を使ったスペクトル列の手法とも自然に結びつき、Weil予想などの高次の理論を扱う際に不可欠となる。

> **定理 18.2.1（「良い場合」の両定義の一致）**\
> 位相的にはパラコンパクトな多様体や、代数的には体上の射影多様体など「適切なクラス」に属する空間と、コヒーレント層など「良い性質」をもつ層を考えるとき、Čechコホモロジーと導来関手コホモロジーは一致する。

***

### 18.2.2 降下理論とモジュライへの応用

1. **降下理論 (Descent theory)**
   * **アイデア**: 開被覆で「局所的」に定義された対象（例えばベクトル束や主 $$G$$-バンドル）が、貼り合わせによって大域的な対象を与えるかどうかを研究する。
   * **コホモロジーによる障害**: $$\mathcal{G}$$-トーション（$$\mathcal{G}$$-torsor）を局所的に自明化したとき、貼り合わせの可否はしばしば $$H^1(X, \mathcal{G})$$ によって測られる。より高次のコホモロジー群は、さらに複雑な貼り合わせ障害を捉える。
2. **モジュライ問題 (Moduli problems)**
   * 代数的対象（例えば楕円曲線やベクトル束）の**モジュライ空間**の研究において、変形理論や障害理論を解析する際にコホモロジーが重要な役割を果たす。
   * **無限小変形 (Infinitesimal deformations)**: 特に接束(あるいは接層)のコホモロジー $$H^1$$ は曲線や束の「一次の変形」を記述し、上位コホモロジー群が高次の障害を担う。

歴史的に、これらの手法は数論的にも応用され、複素乗法をもつ楕円曲線の分類やモジュラー曲線上の有理点の研究に不可欠となってきた。グロタンディークの導来関手による視点は、広汎な幾何設定でのコホモロジーを一元的に扱えるようにし、最終的にはワイルズによるフェルマーの最終定理の証明にまで繋がる要となった。

***

## 18.3 交叉理論と数論における役割

幾何学と数論の最も鮮明な連携の一つが**交叉理論**である。これは、下位次元の部分多様体（例えば曲面上の曲線）の「交わり」を研究し、これを代数的な不変量に落とし込む理論である。

### 18.3.1 ディバイザ、交叉数、および算術曲面

> **定義 18.3.1（ディバイザ）**\
> 次元 $$d$$ の既約スキーム $$X$$ において、**ディバイザ**(divisor) とは、$$X$$ 上の余次元1の既約部分多様体（あるいは素因子）の形式的な和を、整数係数で取ったものである。
>
> * （滑らか射影）曲線 $$C$$ 上では、ディバイザは有限個の点の形式和となる。
> * （滑らか射影）曲面 $$S$$ 上では、ディバイザは曲線の形式和として表される。

* **ラインバンドルとの関係**\
  ディバイザは有理函数（あるいはラインバンドルの断面）の零点や極を記録する装置であり、滑らかな射影曲線上ではディバイザとラインバンドルは自然に対応し、これによってピカール群 (Picard group) が定まる。

> **定義 18.3.2（交叉積）**\
> 滑らかな射影曲面 $$S$$ 上の2つの異なる既約曲線 $$C_1$$ と $$C_2$$ の**交叉数** $$C_1 \cdot C_2$$ は、直観的には両者が交わる点をその交わりの重複度（符号を含む）で数えたものである。特異点や「無限遠」での交点も含めるように代数的に拡張される。

**算術曲面**\
算術的な文脈では、数体 $$K$$ の整数環 $$\mathrm{Spec}(\mathcal{O}_K)$$ 上の相対次元 1 のスキーム $$\mathcal{X}$$（いわゆる**算術曲面**）を考える。これは各有限素点（非アルキメデス的な埋め込み）だけでなく無限素点（アルキメデス的な埋め込み）も含むファイバー構造を持つ。算術曲面上の交叉理論では、各有限素点および無限素点での局所寄与を考慮しながら交叉数を定義・計算する。

***

### 18.3.2 局所寄与と高さペアリング

*   **局所交叉数**\
    算術曲面 $$\pi : \mathcal{X} \to \mathrm{Spec}(\mathcal{O}_K)$$ 上で、ディバイザ $$D_1$$ と $$D_2$$ の交叉数は、各素点 $$v$$（有限素点・無限素点を含む）における交叉数 $$(D_1 \cdot D_2)_v$$ の和として表される。記号的には

    $$
    D_1 \cdot D_2 \;=\; \sum_{v} (D_1 \cdot D_2)_v,
    $$

    となり、$$\mathcal{X}_v$$（$$\mathcal{X}$$ を $$K_v$$ へ基底変換したファイバー）の上で各々を計算する。
* **高さペアリング**\
  数論幾何において、**高さ**(height) は代数的な点の「算術的複雑度」を測る道具である。例えば数体 $$K$$ 上の楕円曲線 $$E$$ に対して、**Néron–Tate高さ** と呼ばれる高さは、対応する算術曲面（$$E$$ の極小モデル）上の交叉理論から解釈することができる。局所交叉数をすべて合計することで大域的な高さが得られるのである。

> **例 18.3.3（**$$\mathbb{P}^2$$ **上の2直線の交叉）**\
> 代数閉体上では、射影平面 $$\mathbb{P}^2$$ の2つの異なる直線 $$L_1$$ と $$L_2$$ はちょうど1点で交わる。これは、両直線がそれぞれ次数1であることに対応し、交叉積 $$L_1 \cdot L_2 = 1$$ と計算される。
>
> * 算術的な文脈では、これらの直線を算術曲面に埋め込んだとき、その「1つの交点」が各素点 $$v$$ においてどのように「広がる」か、局所化での重複度がどのように変化するかを考慮する必要がある。

このような理論は**アラケロフ幾何**においてさらに体系化され、有限素点と無限素点を同一の枠組みで扱うことで、代数多様体上の有理点の高さを統一的に理解する基盤を提供する。楕円曲線やモジュラー曲線などの上のディオファントス方程式を取り扱う際に、こうした手法が不可欠となっている。

**歴史的背景**

* **アンドレ・Weil**は、交叉数を厳密に定義し、曲線や曲面上のディバイザ論との関連を確立した。
* **ゲルト・ファルティングス**や**ポール・ヴォイタ**らは、アラケロフ理論を発展させ、算術曲面における交叉理論をアルキメデス的埋め込みも含めて体系化し、高さやディオファントス問題の研究に革命をもたらした。

***

## 結びにかえて

**層**、**スキーム**、そして**コホモロジー**という統一言語は、現代の代数幾何や算術幾何のほとんどすべてを支える基礎である。一見すると抽象的に見えるこれらの概念だが、もともとは体以外の環上の多項式解集合をどのように整合的に捉えるか、あるいは局所的な解を大域的に貼り合わせるための障害は何か、などの自然な問いから生まれた。

* **スキーム**の枠組みは「解集合」を $$\mathrm{Spec}(R)$$ という幾何学的対象に読み替え、そこに内在する代数構造を幾何学的な位相や層に反映させる。
* **層コホモロジー**は、局所から大域へとデータを貼り合わせる際の障害を体系的に捉え、降下理論やモジュライ理論、分類問題など多方面に応用される。
* **交叉理論**とその算術的拡張（局所寄与や高さペアリングなど）は、幾何学を通して有理点の「複雑度」やディオファントス方程式を研究する強力な手段を与える。

今後、楕円曲線やモジュラー形式、ガロワ表現の研究を深めていく際には、ここで述べた層・スキーム・コホモロジーの道具立てが基本的な下地となり、フェルマーの最終定理の現代的証明をはじめ、数多くの重要な成果を支える理論的支柱として機能するのである。

***
